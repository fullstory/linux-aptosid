From 9b10ec94586a202f8e8690261fc90b3ad00c25c6 Mon Sep 17 00:00:00 2001
From: Larry Finger <Larry.Finger@lwfinger.net>
Date: Tue, 14 May 2013 14:39:04 -0500
Subject: [PATCH 156/390] Remove dead code inside "#ifdef CONFIG_MP_INCLUDED"

Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
---
 Makefile                 |   14 -
 core/rtw_cmd.c           |   11 -
 core/rtw_ioctl_set.c     |    7 -
 core/rtw_recv.c          |   35 --
 hal/rtl8192d_mp.c        | 1523 ----------------------------------------------
 hal/rtl8192du_xmit.c     |    8 +-
 include/Hal8192DPhyCfg.h |   21 -
 include/autoconf.h       |   25 +-
 include/drv_types.h      |    8 -
 include/rtl8192d_hal.h   |   34 --
 include/rtw_ioctl.h      |   10 -
 os_dep/ioctl_cfg80211.c  |    8 -
 os_dep/ioctl_linux.c     | 1493 ++++-----------------------------------------
 os_dep/os_intfs.c        |   34 +-
 14 files changed, 141 insertions(+), 3090 deletions(-)
 delete mode 100644 hal/rtl8192d_mp.c

--- a/drivers/staging/rtl8192du/Makefile
+++ b/drivers/staging/rtl8192du/Makefile
@@ -20,7 +20,6 @@ EXTRA_CFLAGS += -I$(src)/include
 
 CONFIG_AUTOCFG_CP = n
 
-CONFIG_MP_INCLUDED = n
 CONFIG_POWER_SAVING = y
 CONFIG_USB_AUTOSUSPEND = n
 CONFIG_HW_PWRP_DETECTION = n
@@ -75,10 +74,6 @@ _HAL_INTFS_FILES :=	hal/hal_intf.o \
 
 _HAL_INTFS_FILES += hal/$(HCI_NAME)_ops_linux.o
 
-ifeq ($(CONFIG_MP_INCLUDED), y)
-_HAL_INTFS_FILES += hal/$(RTL871X)_mp.o
-endif
-
 _HAL_INTFS_FILES += $(CHIP_FILES)
 
 
@@ -132,12 +127,6 @@ ifneq ($(USER_MODULE_NAME),)
 MODULE_NAME := $(USER_MODULE_NAME)
 endif
 
-ifeq ($(CONFIG_MP_INCLUDED), y)
-MODULE_NAME := $(MODULE_NAME)_mp
-EXTRA_CFLAGS += -DCONFIG_MP_INCLUDED
-endif
-
-
 ifneq ($(KERNELRELEASE),)
 
 
@@ -171,9 +160,6 @@ $(MODULE_NAME)-y += $(_HAL_INTFS_FILES)
 
 $(MODULE_NAME)-y += $(_OS_INTFS_FILES)
 
-$(MODULE_NAME)-$(CONFIG_MP_INCLUDED) += core/rtw_mp.o \
-					core/rtw_mp_ioctl.o
-
 obj-$(CONFIG_RTL8192DU) := $(MODULE_NAME).o
 
 else
--- a/drivers/staging/rtl8192du/core/rtw_cmd.c
+++ b/drivers/staging/rtl8192du/core/rtw_cmd.c
@@ -936,9 +936,6 @@ void rtw_getbbrfreg_cmdrsp_callback(stru
 	kfree(pcmd->parmbuf);
 	kfree(pcmd);
 
-#ifdef CONFIG_MP_INCLUDED
-	padapter->mppriv.workparam.bcompleted = true;
-#endif
 _func_exit_;
 }
 
@@ -949,10 +946,6 @@ void rtw_readtssi_cmdrsp_callback(struct
 	kfree(pcmd->parmbuf);
 	kfree(pcmd);
 
-#ifdef CONFIG_MP_INCLUDED
-	padapter->mppriv.workparam.bcompleted = true;
-#endif
-
 _func_exit_;
 }
 
@@ -2560,9 +2553,5 @@ void rtw_getrttbl_cmd_cmdrsp_callback(st
 _func_enter_;
 
 	rtw_free_cmd_obj(pcmd);
-#ifdef CONFIG_MP_INCLUDED
-	padapter->mppriv.workparam.bcompleted = true;
-#endif
-
 _func_exit_;
 }
--- a/drivers/staging/rtl8192du/core/rtw_ioctl_set.c
+++ b/drivers/staging/rtl8192du/core/rtw_ioctl_set.c
@@ -1064,13 +1064,6 @@ u16 rtw_get_cur_max_rate(struct rtw_adap
 	u32	ht_ielen = 0;
 #endif
 
-#ifdef CONFIG_MP_INCLUDED
-	if (adapter->registrypriv.mp_mode == 1) {
-		if (check_fwstate(pmlmepriv, WIFI_MP_STATE) == true)
-			return 0;
-	}
-#endif
-
 	if ((check_fwstate(pmlmepriv, _FW_LINKED) != true) &&
 	    (check_fwstate(pmlmepriv, WIFI_ADHOC_MASTER_STATE) != true))
 		return 0;
--- a/drivers/staging/rtl8192du/core/rtw_recv.c
+++ b/drivers/staging/rtl8192du/core/rtw_recv.c
@@ -1210,10 +1210,6 @@ int sta2sta_data_frame(struct rtw_adapte
 	if (*psta == NULL) {
 		RT_TRACE(_module_rtl871x_recv_c_, _drv_err_,
 			 ("can't get psta under sta2sta_data_frame ; drop pkt\n"));
-#ifdef CONFIG_MP_INCLUDED
-		if (check_fwstate(pmlmepriv, WIFI_MP_STATE) == true)
-			adapter->mppriv.rx_pktloss++;
-#endif
 		ret = _FAIL;
 		goto exit;
 	}
@@ -2788,27 +2784,6 @@ int recv_func_prehandle(struct rtw_adapt
 	struct recv_priv *precvpriv = &padapter->recvpriv;
 	struct __queue *pfree_recv_queue = &padapter->recvpriv.free_recv_queue;
 
-#ifdef CONFIG_MP_INCLUDED
-	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-#endif /* CONFIG_MP_INCLUDED */
-
-#ifdef CONFIG_MP_INCLUDED
-	if ((check_fwstate(pmlmepriv, WIFI_MP_STATE) == true)) {	/* padapter->mppriv.check_mp_pkt == 0)) */
-		if (pattrib->crc_err == 1)
-			padapter->mppriv.rx_crcerrpktcount++;
-		else
-			padapter->mppriv.rx_pktcount++;
-
-		if (check_fwstate(pmlmepriv, WIFI_MP_LPBK_STATE) == false) {
-			RT_TRACE(_module_rtl871x_recv_c_, _drv_alert_,
-				 ("MP - Not in loopback mode , drop pkt\n"));
-			ret = _FAIL;
-			rtw_free_recvframe(rframe, pfree_recv_queue);	/* free this recv_frame */
-			goto exit;
-		}
-	}
-#endif
-
 	/* check the frame crtl field and decache */
 	ret = validate_recv_frame(padapter, rframe);
 	if (ret != _SUCCESS) {
@@ -2831,10 +2806,6 @@ int recv_func_posthandle(struct rtw_adap
 	struct recv_priv *precvpriv = &padapter->recvpriv;
 	struct __queue *pfree_recv_queue = &padapter->recvpriv.free_recv_queue;
 
-#ifdef CONFIG_MP_INCLUDED
-	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-#endif /* CONFIG_MP_INCLUDED */
-
 #ifdef CONFIG_TDLS
 	u8 *psnap_type, *pcategory;
 	struct sta_info *ptdls_sta = NULL;
@@ -3064,12 +3035,6 @@ s32 rtw_recv_entry(union recv_frame *pre
 
 _recv_entry_drop:
 
-#ifdef CONFIG_MP_INCLUDED
-	padapter->mppriv.rx_pktloss = precvpriv->rx_drop;
-#endif
-
-	/* RT_TRACE(_module_rtl871x_recv_c_,_drv_err_,("_recv_entry_drop\n")); */
-
 	_func_exit_;
 
 	return ret;
--- a/drivers/staging/rtl8192du/hal/rtl8192d_mp.c
+++ /dev/null
@@ -1,1523 +0,0 @@
-/******************************************************************************
- *
- * Copyright(c) 2007 - 2011 Realtek Corporation. All rights reserved.
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it will be useful, but WITHOUT
- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
- * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
- * more details.
- *
- * You should have received a copy of the GNU General Public License along with
- * this program; if not, write to the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110, USA
- *
- *
- ******************************************************************************/
-#define _RTL8192D_MP_C_
-#ifdef CONFIG_MP_INCLUDED
-
-#include <drv_types.h>
-#include <rtw_mp.h>
-#include <rtl8192d_hal.h>
-
-#define IQK_DELAY_TIME		1	//ms
-
-#define PHY_IQCalibrate(a)	rtl8192d_PHY_IQCalibrate(a)
-#define PHY_LCCalibrate(a)	rtl8192d_PHY_LCCalibrate(a)
-#define dm_CheckTXPowerTracking(a)	rtl8192d_dm_CheckTXPowerTracking(a)
-#define PHY_SetRFPathSwitch(a,b)	rtl8192d_PHY_SetRFPathSwitch(a,b)
-
-void Hal_MptSet8256CCKTxPower(PADAPTER pAdapter,u8 *pTxPower)
-{
-	u8				TxAGC[2]={0, 0};
-	u32			 tmpval=0;
-	u8				rf;
-	for (rf=0; rf<2; rf++)
-		TxAGC[rf] = pTxPower[rf];
-
-	// rf-A cck tx power
-	PHY_SetBBReg(pAdapter, rTxAGC_A_CCK1_Mcs32, bMaskByte1, TxAGC[RF_PATH_A]);
-
-	tmpval = (TxAGC[RF_PATH_A]<<16)|(TxAGC[RF_PATH_A]<<8)|(TxAGC[RF_PATH_A]);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_CCK11_A_CCK2_11, 0xffffff00, tmpval);
-
-	// rf-B cck tx power
-	PHY_SetBBReg(pAdapter, rTxAGC_B_CCK11_A_CCK2_11, bMaskByte0, TxAGC[RF_PATH_B]);
-
-	tmpval = (TxAGC[RF_PATH_B]<<16)|(TxAGC[RF_PATH_B]<<8)|(TxAGC[RF_PATH_B]);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_CCK1_55_Mcs32, 0xffffff00, tmpval);
-}
-
-
-void Hal_MptSet8256OFDMTxPower(PADAPTER pAdapter,u8 *pTxPower)
-{
-	u32			 TxAGC=0;
-	u8 tmpval=0;
-	u8 rf;
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(pAdapter);
-	PMPT_CONTEXT		pMptCtx = &(pAdapter->mppriv.MptCtx);
-	struct dm_priv	*pdmpriv = &pHalData->dmpriv;
-
-	tmpval = pTxPower[0];
-	TxAGC |= ((tmpval<<24)|(tmpval<<16)|(tmpval<<8)|tmpval);
-
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Rate18_06, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Rate54_24, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Mcs03_Mcs00, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Mcs07_Mcs04, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Mcs11_Mcs08, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_A_Mcs15_Mcs12, bMaskDWord, TxAGC);
-
-	TxAGC=0;
-	tmpval = pTxPower[1];
-	TxAGC |= ((tmpval<<24)|(tmpval<<16)|(tmpval<<8)|tmpval);
-
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Rate18_06, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Rate54_24, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Mcs03_Mcs00, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Mcs07_Mcs04, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Mcs11_Mcs08, bMaskDWord, TxAGC);
-	PHY_SetBBReg(pAdapter, rTxAGC_B_Mcs15_Mcs12, bMaskDWord, TxAGC);
-
-
-}
-
-
-void Hal_SetAntenna(PADAPTER pAdapter)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(pAdapter);
-
-	R_ANTENNA_SELECT_OFDM *p_ofdm_tx;	/* OFDM Tx register */
-	R_ANTENNA_SELECT_CCK *p_cck_txrx;
-
-	u8	r_rx_antenna_ofdm = 0, r_ant_select_cck_val = 0;
-	u8	chgTx = 0, chgRx = 0;
-	u32 r_ant_sel_cck_val = 0, r_ant_select_ofdm_val = 0, r_ofdm_tx_en_val = 0;
-
-
-	p_ofdm_tx = (R_ANTENNA_SELECT_OFDM *)&r_ant_select_ofdm_val;
-	p_cck_txrx = (R_ANTENNA_SELECT_CCK *)&r_ant_select_cck_val;
-
-	p_ofdm_tx->r_ant_ht1	= 0x1;
-	p_ofdm_tx->r_ant_ht2	= 0x2;	// Second TX RF path is A
-	p_ofdm_tx->r_ant_non_ht = 0x3;	// 0x1+0x2=0x3
-
-	switch (pAdapter->mppriv.antenna_tx)
-	{
-		case ANTENNA_A:
-			p_ofdm_tx->r_tx_antenna		= 0x1;
-			r_ofdm_tx_en_val		= 0x1;
-			p_ofdm_tx->r_ant_l		= 0x1;
-			p_ofdm_tx->r_ant_ht_s1		= 0x1;
-			p_ofdm_tx->r_ant_non_ht_s1	= 0x1;
-			p_cck_txrx->r_ccktx_enable	= 0x8;
-			chgTx = 1;
-
-			// From SD3 Willis suggestion !!! Set RF A=TX and B as standby
-//			if (IS_HARDWARE_TYPE_8192S(pAdapter))
-			{
-			write_bbreg(pAdapter, rFPGA0_XA_HSSIParameter2, 0xe, 2);
-			write_bbreg(pAdapter, rFPGA0_XB_HSSIParameter2, 0xe, 1);
-			r_ofdm_tx_en_val		= 0x3;
-
-			// Power save
-			//cosa r_ant_select_ofdm_val = 0x11111111;
-
-			// We need to close RFB by SW control
-			if (pHalData->rf_type == RF_2T2R)
-			{
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT10, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT26, 1);
-				PHY_SetBBReg(pAdapter, rFPGA0_XB_RFInterfaceOE, BIT10, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT1, 1);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT17, 0);
-			}
-			}
-			break;
-
-		case ANTENNA_B:
-			p_ofdm_tx->r_tx_antenna		= 0x2;
-			r_ofdm_tx_en_val		= 0x2;
-			p_ofdm_tx->r_ant_l		= 0x2;
-			p_ofdm_tx->r_ant_ht_s1		= 0x2;
-			p_ofdm_tx->r_ant_non_ht_s1	= 0x2;
-			p_cck_txrx->r_ccktx_enable	= 0x4;
-			chgTx = 1;
-
-			// From SD3 Willis suggestion !!! Set RF A as standby
-			//if (IS_HARDWARE_TYPE_8192S(pAdapter))
-			{
-			PHY_SetBBReg(pAdapter, rFPGA0_XA_HSSIParameter2, 0xe, 1);
-			PHY_SetBBReg(pAdapter, rFPGA0_XB_HSSIParameter2, 0xe, 2);
-//			r_ofdm_tx_en_val		= 0x3;
-
-			// Power save
-			//cosa r_ant_select_ofdm_val = 0x22222222;
-
-			// 2008/10/31 MH From SD3 Willi's suggestion. We must read RF 1T table.
-			// 2009/01/08 MH From Sd3 Willis. We need to close RFA by SW control
-			if (pHalData->rf_type == RF_2T2R || pHalData->rf_type == RF_1T2R)
-			{
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT10, 1);
-				PHY_SetBBReg(pAdapter, rFPGA0_XA_RFInterfaceOE, BIT10, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT26, 0);
-//				PHY_SetBBReg(pAdapter, rFPGA0_XB_RFInterfaceOE, BIT10, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT1, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT17, 1);
-			}
-			}
-		break;
-
-		case ANTENNA_AB:	// For 8192S
-			p_ofdm_tx->r_tx_antenna		= 0x3;
-			r_ofdm_tx_en_val		= 0x3;
-			p_ofdm_tx->r_ant_l		= 0x3;
-			p_ofdm_tx->r_ant_ht_s1		= 0x3;
-			p_ofdm_tx->r_ant_non_ht_s1	= 0x3;
-			p_cck_txrx->r_ccktx_enable	= 0xC;
-			chgTx = 1;
-
-			// From SD3 Willis suggestion !!! Set RF B as standby
-			PHY_SetBBReg(pAdapter, rFPGA0_XA_HSSIParameter2, 0xe, 2);
-			PHY_SetBBReg(pAdapter, rFPGA0_XB_HSSIParameter2, 0xe, 2);
-
-			// Disable Power save
-			//cosa r_ant_select_ofdm_val = 0x3321333;
-			// 2009/01/08 MH From Sd3 Willis. We need to enable RFA/B by SW control
-			if (pHalData->rf_type == RF_2T2R) {
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT10, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFInterfaceSW, BIT26, 0);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT1, 1);
-				PHY_SetBBReg(pAdapter, rFPGA0_XAB_RFParameter, BIT17, 1);
-			}
-			break;
-
-		default:
-			break;
-	}
-
-	//
-	// r_rx_antenna_ofdm, bit0=A, bit1=B, bit2=C, bit3=D
-	// r_cckrx_enable : CCK default, 0=A, 1=B, 2=C, 3=D
-	// r_cckrx_enable_2 : CCK option, 0=A, 1=B, 2=C, 3=D
-	//
-	switch (pAdapter->mppriv.antenna_rx)
-	{
-		case ANTENNA_A:
-			r_rx_antenna_ofdm		= 0x1;	// A
-			p_cck_txrx->r_cckrx_enable	= 0x0;	// default: A
-			p_cck_txrx->r_cckrx_enable_2	= 0x0;	// option: A
-			chgRx = 1;
-			break;
-
-		case ANTENNA_B:
-			r_rx_antenna_ofdm		= 0x2;	// B
-			p_cck_txrx->r_cckrx_enable	= 0x1;	// default: B
-			p_cck_txrx->r_cckrx_enable_2	= 0x1;	// option: B
-			chgRx = 1;
-			break;
-
-		case ANTENNA_AB:
-			r_rx_antenna_ofdm		= 0x3;	// AB
-			p_cck_txrx->r_cckrx_enable	= 0x0;	// default:A
-			p_cck_txrx->r_cckrx_enable_2	= 0x1;	// option:B
-			chgRx = 1;
-			break;
-
-		default:
-			break;
-	}
-
-	if (chgTx && chgRx) {
-		switch (pHalData->rf_chip) {
-		case RF_8225:
-		case RF_8256:
-		case RF_6052:
-			//r_ant_sel_cck_val = r_ant_select_cck_val;
-			PHY_SetBBReg(pAdapter, rFPGA1_TxInfo, 0x7fffffff, r_ant_select_ofdm_val);	//OFDM Tx
-			PHY_SetBBReg(pAdapter, rFPGA0_TxInfo, 0x0000000f, r_ofdm_tx_en_val);		//OFDM Tx
-			PHY_SetBBReg(pAdapter, rOFDM0_TRxPathEnable, 0x0000000f, r_rx_antenna_ofdm);	//OFDM Rx
-			PHY_SetBBReg(pAdapter, rOFDM1_TRxPathEnable, 0x0000000f, r_rx_antenna_ofdm);	//OFDM Rx
-			PHY_SetBBReg(pAdapter, rCCK0_AFESetting, bMaskByte3, r_ant_select_cck_val);//r_ant_sel_cck_val);		//CCK TxRx
-			if (pHalData->CurrentBandType92D == BAND_ON_2_4G || IS_92D_SINGLEPHY(pHalData->VersionID))
-					rtw_write8(pAdapter, rCCK0_AFESetting+3, r_ant_select_cck_val);
-			break;
-		default:
-			break;
-		}
-	}
-	RT_TRACE(_module_mp_, _drv_notice_, ("-SwitchAntenna: finished\n"));
-}
-
-s32 Hal_SetPowerTracking(PADAPTER padapter, u8 enable)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(padapter);
-	struct dm_priv	*pdmpriv = &pHalData->dmpriv;
-
-
-	if (!netif_running(padapter->pnetdev)) {
-		RT_TRACE(_module_mp_, _drv_warning_, ("SetPowerTracking! Fail: interface not opened!\n"));
-		return _FAIL;
-	}
-
-	if (check_fwstate(&padapter->mlmepriv, WIFI_MP_STATE) == false) {
-		RT_TRACE(_module_mp_, _drv_warning_, ("SetPowerTracking! Fail: not in MP mode!\n"));
-		return _FAIL;
-	}
-
-	if (enable)
-		pdmpriv->TxPowerTrackControl = true;
-	else
-		pdmpriv->TxPowerTrackControl = false;
-
-	return _SUCCESS;
-}
-
-void Hal_GetPowerTracking(PADAPTER padapter, u8 *enable)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(padapter);
-	struct dm_priv	*pdmpriv = &pHalData->dmpriv;
-
-
-	*enable = pdmpriv->TxPowerTrackControl;
-}
-
-
-
-void Hal_SetCarrierSuppressionTx(PADAPTER pAdapter, u8 bStart)
-{
-   // PMGNT_INFO          pMgntInfo = &(pAdapter->MgntInfo);
-    HAL_DATA_TYPE       *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT	pMptCtx = &pAdapter->mppriv.MptCtx;
-
-
-    if (bStart)
-    { // Start Carrier Suppression.
-        //if (pMgntInfo->dot11CurrentWirelessMode == WIRELESS_MODE_B)
-        if (pMptCtx->MptRateIndex >= MPT_RATE_1M &&
-            pMptCtx->MptRateIndex <= MPT_RATE_11M)
-        { // Start CCK Carrier Suppression
-            // 1. if CCK block on?
-            if (!PHY_QueryBBReg(pAdapter, rFPGA0_RFMOD, bCCKEn))
-                PHY_SetBBReg(pAdapter, rFPGA0_RFMOD, bCCKEn, bEnable);//set CCK block on
-
-            //Turn Off All Test Mode
-            PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-            PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-            PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, 0x2);    //transmit mode
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, 0x0);  //turn off scramble setting
-                //Set CCK Tx Test Rate
-            //PHY_SetBBReg(pAdapter, rCCK0_System, bCCKTxRate, pMgntInfo->ForcedDataRate);
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKTxRate, 0x0);    //Set FTxRate to 1Mbps
-        }
-    }
-    else
-    { // Stop Carrier Suppression.
-        //if (pMgntInfo->dot11CurrentWirelessMode == WIRELESS_MODE_B)
-        if (pMptCtx->MptRateIndex >= MPT_RATE_1M &&
-            pMptCtx->MptRateIndex <= MPT_RATE_11M)
-        { // Stop Carrier Suppression
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, 0x0);    //normal mode
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, 0x1);  //turn on scramble setting
-
-            //BB Reset
-            PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-            PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-        }
-    }
-}
-
-
-void Hal_SetSingleToneTx (PADAPTER pAdapter , u8 bStart)
-{
-   // PMGNT_INFO          pMgntInfo = &(pAdapter->MgntInfo);
-    HAL_DATA_TYPE       *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT	pMptCtx = &pAdapter->mppriv.MptCtx;
-    u8              CurrChannel = pAdapter->mppriv.channel;
-    u32              ulAntennaTx = pAdapter->mppriv.antenna_tx;
-    bool				is92C = IS_92C_SERIAL(pHalData->VersionID);
-    RF_RADIO_PATH_E   rfPath;
-
-    switch (ulAntennaTx)
-    {
-        case ANTENNA_A:         rfPath = RF_PATH_A;       break;
-        case ANTENNA_B:         rfPath = RF_PATH_B;       break;
-        case ANTENNA_C:         rfPath = RF_PATH_C;       break;
-        default:
-            rfPath = RF_PATH_A;
-            break;
-    }
-    if (bStart)
-    {   // Start Single Tone.
-
-	RT_TRACE(_module_mp_,_drv_alert_, ("SetSingleToneTx: test start\n"));
-		write_bbreg(pAdapter, rFPGA0_RFMOD, bCCKEn, 0x0);
-		write_bbreg(pAdapter, rFPGA0_RFMOD, bOFDMEn, 0x0);
-		if (is92C)
-	{
-			_write_rfreg(pAdapter, RF_PATH_A, 0x21, BIT19, 0x01);
-			rtw_usleep_os(100);
-			if (rfPath == RF_PATH_A)
-				write_rfreg(pAdapter, RF_PATH_B, 0x00, 0x10000); // PAD all on.
-			else if (rfPath == RF_PATH_B)
-				write_rfreg(pAdapter, RF_PATH_A, 0x00, 0x10000); // PAD all on.
-			write_rfreg(pAdapter, rfPath, 0x00, 0x2001f); // PAD all on.
-			rtw_usleep_os(100);
-		}
-		else
-		{
-			write_rfreg(pAdapter, rfPath, 0x21, 0xd4000);
-			rtw_usleep_os(100);
-			write_rfreg(pAdapter, rfPath, 0x00, 0x2001f); // PAD all on.
-			rtw_usleep_os(100);
-		}
-		// Turn On Continue Tx and turn off the other test modes.
-		PHY_SetBBReg(pAdapter, rOFDM1_LSTF, BIT30|BIT29|BIT28, OFDM_SingleTone);
-    }
-    else
-    {   // Stop Single Tone.
-	RT_TRACE(_module_mp_,_drv_alert_, ("SetSingleToneTx: test stop\n"));
-		write_bbreg(pAdapter, rFPGA0_RFMOD, bCCKEn, 0x1);
-		write_bbreg(pAdapter, rFPGA0_RFMOD, bOFDMEn, 0x1);
-
-		if (is92C)
-		{
-			_write_rfreg(pAdapter, RF_PATH_A, 0x21, BIT19, 0x00);
-			rtw_usleep_os(100);
-			write_rfreg(pAdapter, RF_PATH_A, 0x00, 0x32d75); // PAD all on.
-			write_rfreg(pAdapter, RF_PATH_B, 0x00, 0x32d75); // PAD all on.
-			rtw_usleep_os(100);
-		} else {
-			write_rfreg(pAdapter, rfPath, 0x21, 0x54000);
-			rtw_usleep_os(100);
-			write_rfreg(pAdapter, rfPath, 0x00, 0x30000); // PAD all on.
-			rtw_usleep_os(100);
-		}
-			// Turn off all test modes.
-		PHY_SetBBReg(pAdapter, rOFDM1_LSTF, BIT30|BIT29|BIT28, OFDM_ALL_OFF);
-
-    }
-}
-
-
-s32 Hal_SetThermalMeter(PADAPTER pAdapter, u8 target_ther)
-{
-	HAL_DATA_TYPE *pHalData = GET_HAL_DATA(pAdapter);
-
-
-	if (!netif_running(pAdapter->pnetdev)) {
-		RT_TRACE(_module_mp_, _drv_warning_, ("SetThermalMeter! Fail: interface not opened!\n"));
-		return _FAIL;
-	}
-
-	if (check_fwstate(&pAdapter->mlmepriv, WIFI_MP_STATE) == false) {
-		RT_TRACE(_module_mp_, _drv_warning_, ("SetThermalMeter: Fail! not in MP mode!\n"));
-		return _FAIL;
-	}
-
-	target_ther &= 0xff;
-	if (target_ther < 0x07)
-		target_ther = 0x07;
-	else if (target_ther > 0x1d)
-		target_ther = 0x1d;
-
-	pHalData->EEPROMThermalMeter = target_ther;
-
-	return _SUCCESS;
-}
-
-
-void Hal_TriggerRFThermalMeter(PADAPTER pAdapter)
-{
-   // PADAPTER			  pAdapter = (PADAPTER)Context;
-	PHY_SetRFReg(pAdapter, RF_PATH_A, RF_T_METER, BIT17 | BIT16, 0x03);
-}
-
-
-u8 Hal_ReadRFThermalMeter(PADAPTER pAdapter)
-{
-	u32 ThermalValue = 0;
-
-	ThermalValue = _read_rfreg(pAdapter, RF_PATH_A, RF_T_METER, 0xf800);	//0x42: RF Reg[15:11]
-//	RT_TRACE(_module_mp_, _drv_alert_, ("ThermalValue = 0x%x\n", ThermalValue));
-	return (u8)ThermalValue;
-}
-
-
-void Hal_GetThermalMeter(PADAPTER pAdapter, u8 *value)
-{
-	Hal_TriggerRFThermalMeter(pAdapter);
-	rtw_msleep_os(1000);
-	*value = Hal_ReadRFThermalMeter(pAdapter);
-}
-
-void Hal_SetTxPower (PADAPTER pAdapter)
-{
-	HAL_DATA_TYPE		*pHalData	= GET_HAL_DATA(pAdapter);
-	//u1Byte				CurrChannel;
-	u8                  TxPowerLevel_CCK[2], TxPowerLevel_HTOFDM[2];
-    PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-	u8				rf;
-
-	printk("%s",__func__);
-
-    TxPowerLevel_CCK[RF_PATH_A] = pAdapter->mppriv.txpoweridx;
-	TxPowerLevel_CCK[RF_PATH_B] = pAdapter->mppriv.txpoweridx_b;
-    TxPowerLevel_HTOFDM[RF_PATH_A] = pAdapter->mppriv.txpoweridx;
-	TxPowerLevel_HTOFDM[RF_PATH_B] = pAdapter->mppriv.txpoweridx_b;
-
-	for (rf=0; rf<2; rf++)
-	{
-		if (IS_HARDWARE_TYPE_8192D(pAdapter))
-		{
-			//RT_TRACE(COMP_MP, DBG_LOUD, ("antenna settings txpath 0x%x\n", pHalData->AntennaTxPath));
-			switch (pHalData->AntennaTxPath)
-			{
-				case ANTENNA_B:
-					TxPowerLevel_CCK[rf] = pAdapter->mppriv.txpoweridx_b;
-					break;
-
-				case ANTENNA_A:
-				case ANTENNA_AB:
-				default:
-					TxPowerLevel_CCK[rf] =pAdapter->mppriv.txpoweridx;
-					break;
-			}
-		}
-	}
-	switch (pHalData->rf_chip)
-	{
-		// 2008/09/12 MH Test only !! We enable the TX power tracking for MP!!!!!
-		// We should call normal driver API later!!
-		case RF_8225:
-		case RF_8256:
-		case RF_6052:
-			Hal_MptSet8256CCKTxPower(pAdapter, &TxPowerLevel_CCK[0]);
-			Hal_MptSet8256OFDMTxPower(pAdapter, &TxPowerLevel_HTOFDM[0]);
-			break;
-
-		default:
-			break;
-	}
-	//DbgPrint("\n MPT_ProSetTxPower() is finished\n");
-}
-
-
-void Hal_SetSingleCarrierTx (PADAPTER pAdapter, u8 bStart)
-{
-    HAL_DATA_TYPE       *pHalData   = GET_HAL_DATA(pAdapter);
-    u8              CurrChannel = pAdapter->mppriv.channel;
-     PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-
-    if (bStart)
-    {// Start Single Carrier.
-        // 1. if OFDM block on?
-        if (!PHY_QueryBBReg(pAdapter, rFPGA0_RFMOD, bOFDMEn))
-            PHY_SetBBReg(pAdapter, rFPGA0_RFMOD, bOFDMEn, bEnable);//set OFDM block on
-
-        if (pHalData->CurrentBandType92D == BAND_ON_2_4G)
-        {
-            // 2. set CCK test mode off, set to CCK normal mode
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, bDisable);
-
-            // 3. turn on scramble setting
-            PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, bEnable);
-        }
-
-        // 4. Turn On Continue Tx and turn off the other test modes.
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bEnable);
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-    }
-    else
-    { // Stop Single Carrier.
-        //Turn off all test modes.
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-        PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-        //Delay 10 ms
-        rtw_mdelay_os(10);
-        //BB Reset
-        PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-        PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-    }
-}
-
-static  void Hal_mpt_StartCckContTx(PADAPTER pAdapter,bool bScrambleOn)
-{
-
-    HAL_DATA_TYPE   *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT        pMptCtx = &pAdapter->mppriv.MptCtx;
-    //u1Byte            u1bReg;
-    //u4Byte            data;
-    //u1Byte            CckTxAGC;
-    u32          cckrate;
-
-    // 1. if CCK block on?
-    if (!PHY_QueryBBReg(pAdapter, rFPGA0_RFMOD, bCCKEn))
-        PHY_SetBBReg(pAdapter, rFPGA0_RFMOD, bCCKEn, bEnable);//set CCK block on
-
-    //Turn Off All Test Mode
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-    //Set CCK Tx Test Rate
-    switch (pAdapter->mppriv.rateidx)
-    {
-        case 2:
-            cckrate = 0;
-            break;
-        case 4:
-            cckrate = 1;
-            break;
-        case 11:
-            cckrate = 2;
-            break;
-        case 22:
-            cckrate = 3;
-            break;
-        default:
-            cckrate = 0;
-            break;
-    }
-    PHY_SetBBReg(pAdapter, rCCK0_System, bCCKTxRate, cckrate);
-
-    PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, 0x2);    //transmit mode
-    PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, 0x1);  //turn on scramble setting
-
-    pMptCtx->bCckContTx = true;
-    pMptCtx->bOfdmContTx = false;
-}   /* mpt_StartCckContTx */
-
-
-static  void Hal_mpt_StopCckCoNtTx(PADAPTER pAdapter)
-{
-    HAL_DATA_TYPE   *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-
-    u8          u1bReg;
-
-    pMptCtx->bCckContTx = false;
-    pMptCtx->bOfdmContTx = false;
-
-    PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, 0x0);    //normal mode
-    PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, 0x1);  //turn on scramble setting
-
-    //BB Reset
-    PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-    PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-}   /* mpt_StopCckCoNtTx */
-
-
-static  void Hal_mpt_StartOfdmContTx(PADAPTER pAdapter)
-{
-
-    HAL_DATA_TYPE   *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-    //u1Byte            u1bReg;
-    //u4Byte            data;
-    //u1Byte            OfdmTxAGC;
-
-    // 1. if OFDM block on?
-    if (!PHY_QueryBBReg(pAdapter, rFPGA0_RFMOD, bOFDMEn))
-        PHY_SetBBReg(pAdapter, rFPGA0_RFMOD, bOFDMEn, bEnable);//set OFDM block on
-
-    if (pHalData->CurrentBandType92D == BAND_ON_2_4G)
-    {
-        // 2. set CCK test mode off, set to CCK normal mode
-        PHY_SetBBReg(pAdapter, rCCK0_System, bCCKBBMode, bDisable);
-
-        // 3. turn on scramble setting
-        PHY_SetBBReg(pAdapter, rCCK0_System, bCCKScramble, bEnable);
-    }
-
-    // 4. Turn On Continue Tx and turn off the other test modes.
-       PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bEnable);
-       PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-       PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-
-    pMptCtx->bCckContTx = false;
-    pMptCtx->bOfdmContTx = true;
-    //pMptCtx->bCtxTriggerPktSent = false;
-}   /* mpt_StartOfdmContTx */
-
-
-static  void Hal_mpt_StopOfdmContTx(PADAPTER pAdapter)
-{
-    HAL_DATA_TYPE   *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-    u8          u1bReg;
-    u32          data;
-
-    pMptCtx->bCckContTx = false;
-    pMptCtx->bOfdmContTx = false;
-
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-    PHY_SetBBReg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-    //Delay 10 ms
-    rtw_msleep_os(10);
-    //BB Reset
-    PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-    PHY_SetBBReg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-}   /* mpt_StopOfdmContTx */
-
-
-void Hal_SetContinuousTx (PADAPTER pAdapter, u8 bStart)
-{
-    HAL_DATA_TYPE       *pHalData   = GET_HAL_DATA(pAdapter);
-    PMPT_CONTEXT        pMptCtx = &(pAdapter->mppriv.MptCtx);
-
-    if (bStart)
-    { // Start Continuous Tx.
-        if (pAdapter->mppriv.rateidx >= MPT_RATE_1M &&
-            pAdapter->mppriv.rateidx <= MPT_RATE_11M)
-            Hal_mpt_StartCckContTx(pAdapter, true);
-        else if (pAdapter->mppriv.rateidx >= MPT_RATE_6M &&
-                pAdapter->mppriv.rateidx <= MPT_RATE_MCS15)
-            Hal_mpt_StartOfdmContTx(pAdapter);
-        else
-        {
-            //RT_ASSERT(false, ("MPT_ProSetUpContTx(): Unknown wireless rate index: %d\n", pMptCtx->MptRateIndex));
-            pMptCtx->bStartContTx = false;
-            pMptCtx->bCckContTx = false;
-            pMptCtx->bOfdmContTx = false;
-        }
-
-    }
-    else
-    { // Stop Continuous Tx.
-        bool bCckContTx = pMptCtx->bCckContTx;
-        bool bOfdmContTx = pMptCtx->bOfdmContTx;
-
-        if (bCckContTx == true && bOfdmContTx == false)
-        { // Stop CCK Continuous Tx.
-            Hal_mpt_StopCckCoNtTx(pAdapter);
-        }
-        else if (bCckContTx == false && bOfdmContTx == true)
-        { // Stop OFDM Continuous Tx.
-            Hal_mpt_StopOfdmContTx(pAdapter);
-        }
-        else if (bCckContTx == false && bOfdmContTx == false)
-        { // We've already stopped Continuous Tx.
-        }
-        else
-        { // Unexpected case.
-
-        }
-    }
-}
-
-
-/*---------------------------Define Local Constant---------------------------*/
-
-/*---------------------------Define Local Constant---------------------------*/
-
-
-/*------------------------Define global variable-----------------------------*/
-/*------------------------Define global variable-----------------------------*/
-
-
-/*------------------------Define local variable------------------------------*/
-/*------------------------Define local variable------------------------------*/
-
-
-/*---------------------Define local function prototype-----------------------*/
-
-/*---------------------Define local function prototype-----------------------*/
-u4Byte RT8192DU_Reg_Offset_Conver(PADAPTER Adapter, u4Byte offset)
-{
-	//if (Adapter->interfaceIndex!=0)
-	//{
-		if (offset < 0x1000)
-			offset|=0x4000;
-		else if ((offset&MAC1_ACCESS_PHY0) && !(offset&0x8000))// MAC1 need to access PHY0
-			offset &= 0xFFF;
-	//}
-
-	return (offset);
-}
-
-void
-HalWritePCIDwordDBI8192C(
-	IN	PADAPTER			Adapter,
-	IN	u16	 Offset,
-	IN	  u4Byte  Value,
-	IN	u1Byte	Direct
-)
-{
-	rtw_write16(Adapter,REG_DBI_CTRL, ((Offset & 0xFFC)|0xF000));
-	rtw_write32(Adapter, REG_DBI_WDATA, Value);
-	rtw_write8(Adapter, REG_DBI_FLAG, BIT0|Direct);
-
-	//RT_TRACE(COMP_INIT, DBG_TRACE, ("HalWritePCIDwordDBI8192C offset 0x%x direct 0x%x value 0x%x\n", Offset, Direct, Value));
-	return ;
-}
-/**********************************************************************************
-Author:  sherry
-
-Input:	  u2Byte reg ----PCI Configuration Space offset
-		Direct: Read  from	PCI config space, or MAC reg(MAC0 or MAC1 for 92DE)
-		reg 0x352 bit 3 ,dbi_acc_ext(1 表示訪問 register，0表示pcie config)
-			0x352 bit 2，dbi_access_macsel
-
-Output:  u4Byte -------the value of offset
-
-Date:	2009.11.26
-
-Function: Read PCI Configuration Space after page 1 for Windows XP
-
-***********************************************************************************/
-u4Byte
-HalReadPCIDwordDBI8192C(
-	IN	PADAPTER			Adapter,
-	IN	u16	 Offset,
-	IN	u8	Direct
-)
-{
-	u4Byte value;
-
-	_rtw_write16(Adapter,REG_DBI_CTRL, (Offset & 0xFFC));
-	_rtw_write8(Adapter, REG_DBI_FLAG, BIT1|Direct);
-	rtw_msleep_os(10);
-	value = _rtw_read32(Adapter, REG_DBI_RDATA);
-
-	//RT_TRACE(COMP_IO, DBG_TRACE, ("HalReadPCIDwordDBI8192C offset 0x%x direct 0x%x value 0x%x\n", Offset, Direct, value));
-
-	return value ;
-}
-
-
-void
-PHY_PowerDownAnotherPHY(
-	IN	PADAPTER		Adapter,
-	IN	bool			bMac0
-	)
-{
-//	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(Adapter);
-	u1Byte					u1bTmp;
-	u1Byte			MAC_REG = (bMac0==true)? REG_MAC1:REG_MAC0;
-	u1Byte			MAC_ON_BIT = (bMac0==true)? MAC1_ON:MAC0_ON;
-	u4Byte			MaskforPhySet = 0;
-
-	  // check MAC0 enable or not again now, if enabled, not power down radio A.
-	u1bTmp = _rtw_read8(Adapter, MAC_REG);
-
-	if (!(u1bTmp&MAC_ON_BIT))
-	{
-
-		// power down RF radio A according to YuNan's advice.
-		if (bMac0)
-			MaskforPhySet = MAC0_ACCESS_PHY1;
-		else
-			MaskforPhySet = MAC1_ACCESS_PHY0;
-		  _rtw_write32(Adapter, rFPGA0_XA_LSSIParameter|MaskforPhySet, 0x00000000);
-	}
-}
-
-/*------------------------Define function prototype--------------------------*/
-//
-// 2011/02/10 MH Move the function from Halrf6052.c to Halrf6052_92D.c.
-//
-bool
-PHY_EnableAnotherPHY(
-	IN	PADAPTER		Adapter,
-	IN	bool			bMac0
-	)
-{
-	u1Byte					u1bTmp;
-	u1Byte			MAC_REG = (bMac0==true)?REG_MAC1:REG_MAC0;
-	u1Byte			MAC_ON_BIT = bMac0==true?MAC1_ON:MAC0_ON;
-	bool			bResult = true; //true: need to enable BB/RF power
-	//MAC0 Need PHY1 load radio_b.txt . Driver use DBI to write.
-	 u1bTmp = _rtw_read8(Adapter, MAC_REG);
-
-	  if (!(u1bTmp&MAC_ON_BIT)) {
-	   // Enable BB and RF power
-		if (bMac0)
-			MaskForPHYSet = MAC0_ACCESS_PHY1;
-		else
-			MaskForPHYSet = MAC1_ACCESS_PHY0;
-		_rtw_write16(Adapter, REG_SYS_FUNC_EN|MaskForPHYSet, _rtw_read16(Adapter, REG_SYS_FUNC_EN|MaskForPHYSet)&0xFFFC);
-		_rtw_write16(Adapter, REG_SYS_FUNC_EN|MaskForPHYSet, _rtw_read16(Adapter, REG_SYS_FUNC_EN|MaskForPHYSet)|BIT13|BIT0|BIT1);
-	} else {
-		// We think if MAC1 is ON,then radio_a.txt and radio_b.txt has been load.
-		bResult = false;
-	}
-	return bResult;
-}
-
-
-void
-phy_RestoreRFENV(
-	PADAPTER		Adapter,
-	u8			eRFPath,
-	u32			MaskforPhySet,
-	u32*		pu4RegValue
-	)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(Adapter);
-	BB_REGISTER_DEFINITION_T	*pPhyReg = &pHalData->PHYRegDef[eRFPath];
-
-	//RT_TRACE(COMP_RF, DBG_LOUD, ("=====>phy_RestoreRFENV\n"));
-
-	/*----Restore RFENV control type----*/;
-	switch (eRFPath)
-	{
-		case RF_PATH_A:
-		case RF_PATH_C:
-			PHY_SetBBReg(Adapter, pPhyReg->rfintfs|MaskforPhySet, bRFSI_RFENV, *pu4RegValue);
-			break;
-		case RF_PATH_B :
-		case RF_PATH_D:
-			PHY_SetBBReg(Adapter, pPhyReg->rfintfs|MaskforPhySet, bRFSI_RFENV<<16, *pu4RegValue);
-			break;
-	}
-	//RT_TRACE(COMP_RF, DBG_LOUD, ("<=====phy_RestoreRFENV\n"));
-}
-
-void
-phy_EnableRFENV(
-	IN	PADAPTER		Adapter,
-	IN	u1Byte			eRFPath ,
-	IN	  u4Byte			MaskforPhySet,
-	OUT  u32*		pu4RegValue
-	)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(Adapter);
-	BB_REGISTER_DEFINITION_T	*pPhyReg = &pHalData->PHYRegDef[eRFPath];
-
-	//RT_TRACE(COMP_RF, DBG_LOUD, ("====>phy_EnableRFENV\n"));
-
-	/*----Store original RFENV control type----*/
-	switch (eRFPath)
-	{
-		case RF_PATH_A:
-		case RF_PATH_C:
-			*pu4RegValue = PHY_QueryBBReg(Adapter, pPhyReg->rfintfs|MaskforPhySet, bRFSI_RFENV);
-			break;
-		case RF_PATH_B :
-		case RF_PATH_D:
-			*pu4RegValue = PHY_QueryBBReg(Adapter, pPhyReg->rfintfs|MaskforPhySet, bRFSI_RFENV<<16);
-			break;
-	}
-
-	/*----Set RF_ENV enable----*/
-	PHY_SetBBReg(Adapter, pPhyReg->rfintfe|MaskforPhySet, bRFSI_RFENV<<16, 0x1);
-	rtw_msleep_os(1);
-
-	/*----Set RF_ENV output high----*/
-	PHY_SetBBReg(Adapter, pPhyReg->rfintfo|MaskforPhySet, bRFSI_RFENV, 0x1);
-	rtw_msleep_os(1);
-
-	/* Set bit number of Address and Data for RF register */
-	PHY_SetBBReg(Adapter, pPhyReg->rfHSSIPara2|MaskforPhySet, b3WireAddressLength, 0x0);	// Set 1 to 4 bits for 8255
-	rtw_msleep_os(1);
-
-	PHY_SetBBReg(Adapter, pPhyReg->rfHSSIPara2|MaskforPhySet, b3WireDataLength, 0x0); // Set 0 to 12	bits for 8255
-	rtw_msleep_os(1);
-
-	//RT_TRACE(COMP_RF, DBG_LOUD, ("<====phy_EnableRFENV\n"));
-}
-
-
-/*-----------------------------------------------------------------------------
- * Function:	phy_SwitchRfSetting8192D
- *
- * Overview:	Change RF Setting when we siwthc channel for 92D C-cut.
- *
- * Input:		IN	PADAPTER				pAdapter
- *
- * Output:		NONE
- *
- * Return:		NONE
- *
- * Revised History:
- * When			Who	Remark
- * 01/08/2009	MHC	Suggestion from SD3 Willis for 92S series.
- * 01/09/2009	MHC	Add CCK modification for 40MHZ. Suggestion from SD3.
- *
- *---------------------------------------------------------------------------*/
-
-/*----------------------------Function Body----------------------------------*/
-
-static u8 GetRightChnlPlace(u8 chnl)
-{
-	u8	channel_5G[TARGET_CHNL_NUM_2G_5G] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,149,151,153,155,157,159,161,163,165};
-	u8	place = chnl;
-
-	if (chnl > 14)
-	{
-		for (place = 14; place<sizeof(channel_5G); place++)
-		{
-			if (channel_5G[place] == chnl)
-			{
-				place++;
-				break;
-			}
-		}
-	}
-
-	return place;
-}
-
-
-void
- phy_SwitchRfSetting8192D(
-	PADAPTER				Adapter,
-	u8					channel
-	)
-{
-	HAL_DATA_TYPE		*pHalData = GET_HAL_DATA(Adapter);
-	u8		path = pHalData->CurrentBandType92D == BAND_ON_5G?RF_PATH_A:RF_PATH_B;
-	u8		index = 0,	i = 0, eRFPath = RF_PATH_A;
-	bool		bNeedPowerDownRadio = false, bInteralPA = false;
-	u32		u4RegValue = 0, mask = 0x1C000, value = 0, u4tmp, u4tmp2,MaskforPhySet=0;
-	//Query regB30 bit27
-	u32		Regb30 = PHY_QueryBBReg(Adapter, 0xb30, BIT27);
-
-	//only for 92D SMSP >= C-cut
-	if (!IS_HARDWARE_TYPE_8192D(Adapter))
-		return;
-
-	//config path A for 5G
-	if (pHalData->CurrentBandType92D == BAND_ON_5G)
-	{
-		u4tmp = CurveIndex[GetRightChnlPlace(channel)-1];
-
-		for (i = 0; i < RF_CHNL_NUM_5G; i++) {
-			if (channel == RF_CHNL_5G[i] && channel <= 140)
-				index = 0;
-		}
-
-		for (i = 0; i < RF_CHNL_NUM_5G_40M; i++) {
-			if (channel == RF_CHNL_5G_40M[i] && channel <= 140)
-				index = 1;
-		}
-
-		if (channel ==149 || channel == 155 || channel ==161)
-			index = 2;
-		else if (channel == 151 || channel == 153 || channel == 163 || channel == 165)
-			index = 3;
-		else if (channel == 157 || channel == 159)
-			index = 4;
-
-		if (pHalData->MacPhyMode92D == DUALMAC_DUALPHY && pHalData->interfaceIndex == 1)
-		{
-			bNeedPowerDownRadio = PHY_EnableAnotherPHY(Adapter, false);
-			MaskforPhySet = MAC1_ACCESS_PHY0;
-			//asume no this case
-			if (bNeedPowerDownRadio)
-				phy_EnableRFENV(Adapter, path, MaskforPhySet, &u4RegValue);
-		}
-
-		//DMDP, if band = 5G,Mac0 need to set PHY1 when regB30[27]=1
-		if (Regb30 && pHalData->interfaceIndex == 0)
-		{
-			//RT_TRACE(COMP_MLME, DBG_LOUD, ("===============phy_SwitchRfSetting8192D interface %ld,B30&BIT27=1!!!!\n", Adapter->interfaceIndex));
-
-			bNeedPowerDownRadio = PHY_EnableAnotherPHY(Adapter, true);
-			MaskforPhySet= MAC0_ACCESS_PHY1;
-			//asume no this case
-			if (bNeedPowerDownRadio)
-				phy_EnableRFENV(Adapter, path, MaskforPhySet, &u4RegValue);
-		}
-
-		for (i = 0; i < RF_REG_NUM_for_C_CUT_5G; i++)
-		{
-			if (i == 0 && (pHalData->MacPhyMode92D == DUALMAC_DUALPHY))
-			{
-				PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_5G[i]|MaskforPhySet, bRFRegOffsetMask, 0xE439D);
-			}
-			else if (RF_REG_for_C_CUT_5G[i] == RF_SYN_G4)
-			{
-#if SWLCK == 1
-				u4tmp2= (RF_REG_Param_for_C_CUT_5G[index][i]&0x7FF)|(u4tmp << 11);
-
-				if (channel == 36)
-					u4tmp2 &= ~(BIT7|BIT6);
-
-				PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_5G[i]|MaskforPhySet, bRFRegOffsetMask, u4tmp2);
-#else
-				u4tmp2= RF_REG_Param_for_C_CUT_5G[index][i];
-				PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_5G[i]|MaskforPhySet, 0xFF8FF, u4tmp2);
-#endif
-			}
-			else
-			{
-				PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_5G[i]|MaskforPhySet, bRFRegOffsetMask, RF_REG_Param_for_C_CUT_5G[index][i]);
-			}
-		}
-
-		if (pHalData->MacPhyMode92D == DUALMAC_DUALPHY && pHalData->interfaceIndex == 1)
-		{
-			if (bNeedPowerDownRadio)
-			{
-				phy_RestoreRFENV(Adapter, path,MaskforPhySet, &u4RegValue);
-			}
-			PHY_PowerDownAnotherPHY(Adapter, false);
-		}
-
-		if (Regb30 && pHalData->interfaceIndex == 0)
-		{
-			if (bNeedPowerDownRadio)
-			{
-				phy_RestoreRFENV(Adapter, path,MaskforPhySet, &u4RegValue);
-			}
-			PHY_PowerDownAnotherPHY(Adapter, true);
-		}
-
-		if (channel < 149)
-			value = 0x07;
-		else if (channel >= 149)
-			value = 0x02;
-
-		if (channel >= 36 && channel <= 64)
-			index = 0;
-		else if (channel >=100 && channel <= 140)
-			index = 1;
-		else
-			index = 2;
-
-		for (eRFPath = RF_PATH_A; eRFPath < pHalData->NumTotalRFPath; eRFPath++)
-		{
-			if (pHalData->MacPhyMode92D == DUALMAC_DUALPHY &&
-				pHalData->interfaceIndex == 1)		//MAC 1 5G
-				bInteralPA = pHalData->InternalPA5G[1];
-			else
-				bInteralPA = pHalData->InternalPA5G[eRFPath];
-
-			if (bInteralPA)
-			{
-				for (i = 0; i < RF_REG_NUM_for_C_CUT_5G_internalPA; i++)
-				{
-					if (RF_REG_for_C_CUT_5G_internalPA[i] == 0x03 &&
-						channel >=36 && channel <=64)
-						PHY_SetRFReg(Adapter, eRFPath, RF_REG_for_C_CUT_5G_internalPA[i], bRFRegOffsetMask, 0x7bdef);
-					else
-						PHY_SetRFReg(Adapter, eRFPath, RF_REG_for_C_CUT_5G_internalPA[i], bRFRegOffsetMask, RF_REG_Param_for_C_CUT_5G_internalPA[index][i]);
-					//RT_TRACE(COMP_RF, DBG_LOUD, ("phy_SwitchRfSetting8192D offset 0x%x value 0x%x path %d index %d\n",
-					//	RF_REG_for_C_CUT_5G_internalPA[i], RF_REG_Param_for_C_CUT_5G_internalPA[index][i], eRFPath, index));
-				}
-			}
-			else
-			PHY_SetRFReg(Adapter, eRFPath, RF_TXPA_AG, mask, value);
-		}
-
-	}
-	else if (pHalData->CurrentBandType92D==BAND_ON_2_4G)
-	{
-		//RT_TRACE(COMP_CMD, DBG_LOUD, ("====>phy_SwitchRfSetting8192D interface %d 2.4G\n", Adapter->interfaceIndex));
-		//u4tmp = CurveIndex[channel-1];
-		//RT_DISP(FINIT, INIT_IQK, ("ver 3 set RF-B, 2G, 0x28 = 0x%x !!\n", u4tmp));
-
-		if (channel == 1 || channel == 2 || channel ==4 || channel == 9 || channel == 10 ||
-			channel == 11 || channel ==12)
-			index = 0;
-		else if (channel ==3 || channel == 13 || channel == 14)
-			index = 1;
-		else if (channel >= 5 && channel <= 8)
-			index = 2;
-
-		if (pHalData->MacPhyMode92D == DUALMAC_DUALPHY)
-		{
-			path = RF_PATH_A;
-			if (pHalData->interfaceIndex == 0)
-			{
-				bNeedPowerDownRadio = PHY_EnableAnotherPHY(Adapter, true);
-				MaskforPhySet = MAC0_ACCESS_PHY1;
-				if (bNeedPowerDownRadio)
-					phy_EnableRFENV(Adapter, path,MaskforPhySet,&u4RegValue);
-			}
-
-			//DMDP, if band = 2G,MAC1 need to set PHY0 when regB30[27]=1
-			if (Regb30 && pHalData->interfaceIndex == 1)
-			{
-				//RT_TRACE(COMP_MLME, DBG_LOUD, ("===============phy_SwitchRfSetting8192D interface %ld,B30&BIT27=1!!!!\n", Adapter->interfaceIndex));
-
-				bNeedPowerDownRadio = PHY_EnableAnotherPHY(Adapter, false);
-				MaskforPhySet= MAC1_ACCESS_PHY0;
-				//asume no this case
-				if (bNeedPowerDownRadio)
-					phy_EnableRFENV(Adapter, path,MaskforPhySet,&u4RegValue);
-			}
-		}
-
-
-		for (i = 0; i < RF_REG_NUM_for_C_CUT_2G; i++)
-		{
-#if SWLCK == 1
-			if (RF_REG_for_C_CUT_2G[i] == RF_SYN_G7)
-				PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_2G[i]|MaskforPhySet, bRFRegOffsetMask, (RF_REG_Param_for_C_CUT_2G[index][i] | BIT17));
-			else
-#endif
-			PHY_SetRFReg(Adapter, path, RF_REG_for_C_CUT_2G[i]|MaskforPhySet, bRFRegOffsetMask, RF_REG_Param_for_C_CUT_2G[index][i]);
-		}
-
-#if SWLCK == 1
-		//for SWLCK
-		PHY_SetRFReg(Adapter, path, RF_SYN_G4|MaskforPhySet, bRFRegOffsetMask, RF_REG_SYN_G4_for_C_CUT_2G | (u4tmp << 11));
-#endif
-
-		if (pHalData->MacPhyMode92D == DUALMAC_DUALPHY && pHalData->interfaceIndex == 0)
-		{
-			if (bNeedPowerDownRadio) {
-				phy_RestoreRFENV(Adapter, path,MaskforPhySet, &u4RegValue);
-			}
-			PHY_PowerDownAnotherPHY(Adapter, true);
-		}
-
-		if (Regb30 && pHalData->interfaceIndex == 1)
-		{
-			if (bNeedPowerDownRadio)
-			{
-				phy_RestoreRFENV(Adapter, path,MaskforPhySet, &u4RegValue);
-			}
-			PHY_PowerDownAnotherPHY(Adapter, false);
-		}
-	}
-
-	//RT_TRACE(COMP_CMD, DBG_LOUD, ("<====phy_SwitchRfSetting8192D interface %u\n", Adapter->interfaceIndex));
-}
-
-void Hal_mpt_SwitchRfSetting(PADAPTER pAdapter)
-{
-
-	HAL_DATA_TYPE *pHalData = GET_HAL_DATA(pAdapter);
-	struct mp_priv *pmp = &pAdapter->mppriv;
-	u8 ChannelToSw = pmp->channel, eRFPath = RF_PATH_A;
-	u8 ulRateIdx = pmp->rateidx;
-	u8 ulbandwidth = pmp->bandwidth;
-	PMPT_CONTEXT	pMptCtx = &(pAdapter->mppriv.MptCtx);
-    bool             bInteralPA = false;
-    u32				value = 0;
-    phy_SwitchRfSetting8192D(pAdapter,ChannelToSw);
-}
-
-void Hal_SetBandwidth(PADAPTER pAdapter)
-{
-	struct mp_priv *pmp = &pAdapter->mppriv;
-
-	SetBWMode(pAdapter, pmp->bandwidth, pmp->prime_channel_offset);
-	Hal_mpt_SwitchRfSetting(pAdapter);
-}
-
-
-void MPT_CCKTxPowerAdjust(PADAPTER Adapter,bool	bInCH14)
-{
-	u4Byte				TempVal = 0, TempVal2 = 0, TempVal3 = 0;
-	u4Byte				CurrCCKSwingVal=0, CCKSwingIndex=12;
-	HAL_DATA_TYPE		*pHalData	= GET_HAL_DATA(Adapter);
-	u1Byte				i;
-
-
-	// get current cck swing value and check 0xa22 & 0xa23 later to match the table.
-
-	CurrCCKSwingVal = PHY_QueryBBReg(Adapter, rCCK0_TxFilter1, bMaskHWord);
-
-	if (!bInCH14)
-	{
-		// Readback the current bb cck swing value and compare with the table to
-		// get the current swing index
-		for (i=0 ; i<CCK_TABLE_SIZE ; i++)
-		{
-			if (((CurrCCKSwingVal&0xff) == (u4Byte)CCKSwingTable_Ch1_Ch13[i][0]) &&
-				(((CurrCCKSwingVal&0xff00)>>8) == (u4Byte)CCKSwingTable_Ch1_Ch13[i][1]))
-			{
-				CCKSwingIndex = i;
-				//RT_TRACE(COMP_INIT, DBG_LOUD,("Ch1~13, Current reg0x%x = 0x%lx, CCKSwingIndex=0x%x\n", (rCCK0_TxFilter1+2), CurrCCKSwingVal, CCKSwingIndex));
-				break;
-			}
-		}
-
-		//Write 0xa22 0xa23
-		TempVal =	CCKSwingTable_Ch1_Ch13[CCKSwingIndex][0] +
-					(CCKSwingTable_Ch1_Ch13[CCKSwingIndex][1]<<8) ;
-
-
-		//Write 0xa24 ~ 0xa27
-		TempVal2 = 0;
-		TempVal2 =	CCKSwingTable_Ch1_Ch13[CCKSwingIndex][2] +
-					(CCKSwingTable_Ch1_Ch13[CCKSwingIndex][3]<<8) +
-					(CCKSwingTable_Ch1_Ch13[CCKSwingIndex][4]<<16)+
-					(CCKSwingTable_Ch1_Ch13[CCKSwingIndex][5]<<24);
-
-		//Write 0xa28  0xa29
-		TempVal3 = 0;
-		TempVal3 =	CCKSwingTable_Ch1_Ch13[CCKSwingIndex][6] +
-					(CCKSwingTable_Ch1_Ch13[CCKSwingIndex][7]<<8) ;
-
-
-	}
-	else
-	{
-		for (i=0 ; i<CCK_TABLE_SIZE ; i++)
-		{
-			if (((CurrCCKSwingVal&0xff) == (u4Byte)CCKSwingTable_Ch14[i][0]) &&
-				(((CurrCCKSwingVal&0xff00)>>8) == (u4Byte)CCKSwingTable_Ch14[i][1]))
-			{
-				CCKSwingIndex = i;
-				//RT_TRACE(COMP_INIT, DBG_LOUD,("Ch14, Current reg0x%x = 0x%lx, CCKSwingIndex=0x%x\n", (rCCK0_TxFilter1+2), CurrCCKSwingVal, CCKSwingIndex));
-				break;
-			}
-		}
-
-		//Write 0xa22 0xa23
-		TempVal =	CCKSwingTable_Ch14[CCKSwingIndex][0] +
-					(CCKSwingTable_Ch14[CCKSwingIndex][1]<<8) ;
-
-		//Write 0xa24 ~ 0xa27
-		TempVal2= 0;
-		TempVal2 =	CCKSwingTable_Ch14[CCKSwingIndex][2] +
-					(CCKSwingTable_Ch14[CCKSwingIndex][3]<<8) +
-					(CCKSwingTable_Ch14[CCKSwingIndex][4]<<16)+
-					(CCKSwingTable_Ch14[CCKSwingIndex][5]<<24);
-
-		//Write 0xa28  0xa29
-		TempVal3 = 0;
-		TempVal3 =	CCKSwingTable_Ch14[CCKSwingIndex][6] +
-					(CCKSwingTable_Ch14[CCKSwingIndex][7]<<8) ;
-	}
-
-	PHY_SetBBReg(Adapter, rCCK0_TxFilter1,bMaskHWord, TempVal);
-	//RTPRINT(FMP, MP_SWICH_CH, ("0xA20=0x%x\n", TempVal));
-	PHY_SetBBReg(Adapter, rCCK0_TxFilter2,bMaskDWord, TempVal2);
-	//RTPRINT(FMP, MP_SWICH_CH, ("0xA24=0x%x\n", TempVal2));
-	PHY_SetBBReg(Adapter, rCCK0_DebugPort,bMaskLWord, TempVal3);
-	//RTPRINT(FMP, MP_SWICH_CH, ("0xA28=0x%x\n", TempVal3));
-}
-
-
-void Hal_SetChannel(PADAPTER pAdapter)
-{
-	u8		eRFPath;
-
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(pAdapter);
-	struct mp_priv	*pmp = &pAdapter->mppriv;
-	u8		channel = pmp->channel;
-	u8		bandwidth = pmp->bandwidth;
-	u8		rate = pmp->rateidx;
-
-
-	// set RF channel register
-	for (eRFPath = 0; eRFPath < pHalData->NumTotalRFPath; eRFPath++)
-	{
-	  if (IS_HARDWARE_TYPE_8192D(pAdapter))
-			_write_rfreg(pAdapter, (RF_RADIO_PATH_E)eRFPath, rRfChannel, 0xFF, channel);
-		else
-			_write_rfreg(pAdapter, eRFPath, rRfChannel, 0x3FF, channel);
-	}
-
-	Hal_mpt_SwitchRfSetting(pAdapter);
-
-	SelectChannel(pAdapter, channel);
-
-	if (pHalData->CurrentChannel == 14 && !pHalData->dmpriv.bCCKinCH14) {
-		pHalData->dmpriv.bCCKinCH14 = true;
-		MPT_CCKTxPowerAdjust(pAdapter, pHalData->dmpriv.bCCKinCH14);
-	}
-	else if (pHalData->CurrentChannel != 14 && pHalData->dmpriv.bCCKinCH14) {
-		pHalData->dmpriv.bCCKinCH14 = false;
-		MPT_CCKTxPowerAdjust(pAdapter, pHalData->dmpriv.bCCKinCH14);
-	}
-}
-
-
-void Hal_SetCCKTxPower(PADAPTER pAdapter, u8 *TxPower)
-{
-	u32 tmpval = 0;
-
-
-	// rf-A cck tx power
-	write_bbreg(pAdapter, rTxAGC_A_CCK1_Mcs32, bMaskByte1, TxPower[RF_PATH_A]);
-	tmpval = (TxPower[RF_PATH_A]<<16) | (TxPower[RF_PATH_A]<<8) | TxPower[RF_PATH_A];
-	write_bbreg(pAdapter, rTxAGC_B_CCK11_A_CCK2_11, 0xffffff00, tmpval);
-
-	// rf-B cck tx power
-	write_bbreg(pAdapter, rTxAGC_B_CCK11_A_CCK2_11, bMaskByte0, TxPower[RF_PATH_B]);
-	tmpval = (TxPower[RF_PATH_B]<<16) | (TxPower[RF_PATH_B]<<8) | TxPower[RF_PATH_B];
-	write_bbreg(pAdapter, rTxAGC_B_CCK1_55_Mcs32, 0xffffff00, tmpval);
-
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-SetCCKTxPower: A[0x%02x] B[0x%02x]\n",
-		  TxPower[RF_PATH_A], TxPower[RF_PATH_B]));
-}
-
-
-void Hal_SetOFDMTxPower(PADAPTER pAdapter, u8 *TxPower)
-{
-	u32 TxAGC = 0;
-	u8 tmpval = 0;
-	PMPT_CONTEXT	pMptCtx = &pAdapter->mppriv.MptCtx;
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(pAdapter);
-
-
-	// HT Tx-rf(A)
-	tmpval = TxPower[RF_PATH_A];
-	TxAGC = (tmpval<<24) | (tmpval<<16) | (tmpval<<8) | tmpval;
-
-	write_bbreg(pAdapter, rTxAGC_A_Rate18_06, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_A_Rate54_24, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_A_Mcs03_Mcs00, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_A_Mcs07_Mcs04, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_A_Mcs11_Mcs08, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_A_Mcs15_Mcs12, bMaskDWord, TxAGC);
-
-	// HT Tx-rf(B)
-	tmpval = TxPower[RF_PATH_B];
-	TxAGC = (tmpval<<24) | (tmpval<<16) | (tmpval<<8) | tmpval;
-
-	write_bbreg(pAdapter, rTxAGC_B_Rate18_06, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_B_Rate54_24, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_B_Mcs03_Mcs00, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_B_Mcs07_Mcs04, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_B_Mcs11_Mcs08, bMaskDWord, TxAGC);
-	write_bbreg(pAdapter, rTxAGC_B_Mcs15_Mcs12, bMaskDWord, TxAGC);
-
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-SetOFDMTxPower: A[0x%02x] B[0x%02x]\n",
-		  TxPower[RF_PATH_A], TxPower[RF_PATH_B]));
-}
-
-
-void Hal_SetAntennaPathPower(PADAPTER pAdapter)
-{
-	HAL_DATA_TYPE *pHalData = GET_HAL_DATA(pAdapter);
-	u8 TxPowerLevel[MAX_RF_PATH_NUMS];
-	u8 rfPath;
-
-	TxPowerLevel[RF_PATH_A] = pAdapter->mppriv.txpoweridx;
-	TxPowerLevel[RF_PATH_B] = pAdapter->mppriv.txpoweridx_b;
-
-	switch (pAdapter->mppriv.antenna_tx)
-	{
-		case ANTENNA_A:
-		default:
-			rfPath = RF_PATH_A;
-			break;
-		case ANTENNA_B:
-			rfPath = RF_PATH_B;
-			break;
-		case ANTENNA_C:
-			rfPath = RF_PATH_C;
-			break;
-	}
-
-	switch (pHalData->rf_chip)
-	{
-		case RF_8225:
-		case RF_8256:
-		case RF_6052:
-			Hal_SetCCKTxPower(pAdapter, TxPowerLevel);
-			Hal_SetOFDMTxPower(pAdapter, TxPowerLevel);
-			break;
-
-		default:
-			break;
-	}
-}
-
-void Hal_SetDataRate(PADAPTER pAdapter)
-{
-	Hal_mpt_SwitchRfSetting(pAdapter);
-}
-
-void Hal_SetOFDMContinuousTx(PADAPTER pAdapter, u8 bStart)
-{
-	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(pAdapter);
-
-	if (bStart) {
-		RT_TRACE(_module_mp_, _drv_info_, ("SetOFDMContinuousTx: test start\n"));
-		// 1. if OFDM block on?
-		if (!read_bbreg(pAdapter, rFPGA0_RFMOD, bOFDMEn))
-			write_bbreg(pAdapter, rFPGA0_RFMOD, bOFDMEn, bEnable);//set OFDM block on
-		{
-
-		// 2. set CCK test mode off, set to CCK normal mode
-		write_bbreg(pAdapter, rCCK0_System, bCCKBBMode, bDisable);
-
-		// 3. turn on scramble setting
-		write_bbreg(pAdapter, rCCK0_System, bCCKScramble, bEnable);
-		}
-		// 4. Turn On Continue Tx and turn off the other test modes.
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bEnable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-	} else {
-		RT_TRACE(_module_mp_,_drv_info_, ("SetOFDMContinuousTx: test stop\n"));
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-		//Delay 10 ms
-		rtw_msleep_os(10);
-		//BB Reset
-		write_bbreg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-		write_bbreg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-	}
-
-	pAdapter->mppriv.MptCtx.bCckContTx = false;
-	pAdapter->mppriv.MptCtx.bOfdmContTx = bStart;
-}/* mpt_StartOfdmContTx */
-
-
-void Hal_SetCCKContinuousTx(PADAPTER pAdapter, u8 bStart)
-{
-	u32 cckrate;
-
-	if (bStart)
-	{
-		RT_TRACE(_module_mp_, _drv_alert_,
-			 ("SetCCKContinuousTx: test start\n"));
-
-		// 1. if CCK block on?
-		if (!read_bbreg(pAdapter, rFPGA0_RFMOD, bCCKEn))
-			write_bbreg(pAdapter, rFPGA0_RFMOD, bCCKEn, bEnable);//set CCK block on
-
-		//Turn Off All Test Mode
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMContinueTx, bDisable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleCarrier, bDisable);
-		write_bbreg(pAdapter, rOFDM1_LSTF, bOFDMSingleTone, bDisable);
-		//Set CCK Tx Test Rate
-		cckrate  = pAdapter->mppriv.rateidx;
-		write_bbreg(pAdapter, rCCK0_System, bCCKTxRate, cckrate);
-		write_bbreg(pAdapter, rCCK0_System, bCCKBBMode, 0x2);	//transmit mode
-		write_bbreg(pAdapter, rCCK0_System, bCCKScramble, bEnable); //turn on scramble setting
-
-	} else {
-		RT_TRACE(_module_mp_, _drv_info_,
-			 ("SetCCKContinuousTx: test stop\n"));
-
-		write_bbreg(pAdapter, rCCK0_System, bCCKBBMode, 0x0);	//normal mode
-		write_bbreg(pAdapter, rCCK0_System, bCCKScramble, bEnable); //turn on scramble setting
-
-		//BB Reset
-		write_bbreg(pAdapter, rPMAC_Reset, bBBResetB, 0x0);
-		write_bbreg(pAdapter, rPMAC_Reset, bBBResetB, 0x1);
-	}
-
-	pAdapter->mppriv.MptCtx.bCckContTx = bStart;
-	pAdapter->mppriv.MptCtx.bOfdmContTx = false;
-}/* mpt_StartCckContTx */
-
-
-void Hal_ProSetCrystalCap (PADAPTER pAdapter , u32 CrystalCapVal)
-{
-	HAL_DATA_TYPE		*pHalData	= GET_HAL_DATA(pAdapter);
-
-	if (!IS_HARDWARE_TYPE_8192D(pAdapter))
-		return;
-
-	//CrystalCap = pHalData->CrystalCap;
-
-	PHY_SetBBReg(pAdapter, 0x24, 0xF0, CrystalCapVal & 0x0F);
-	PHY_SetBBReg(pAdapter, 0x28, 0xF0000000, (CrystalCapVal & 0xF0) >> 4);
-}
-
-
-#endif // CONFIG_MP_INCLUDED
--- a/drivers/staging/rtl8192du/hal/rtl8192du_xmit.c
+++ b/drivers/staging/rtl8192du/hal/rtl8192du_xmit.c
@@ -404,13 +404,7 @@ if (padapter->registrypriv.mp_mode == 0)
 		ptxdesc->txdw5 |= cpu_to_le32(ratetohwrate(pmlmeext->tx_rate));
 	} else if ((pxmitframe->frame_tag&0x0f) == TXAGG_FRAMETAG) {
 		DBG_8192D("pxmitframe->frame_tag == TXAGG_FRAMETAG\n");
-	}
-#ifdef CONFIG_MP_INCLUDED
-	else if ((pxmitframe->frame_tag&0x0f) == MP_FRAMETAG) {
-		fill_txdesc_for_mp(padapter, ptxdesc);
-	}
-#endif
-	else {
+	} else {
 		DBG_8192D("pxmitframe->frame_tag = %d\n", pxmitframe->frame_tag);
 
 		//offset 4
--- a/drivers/staging/rtl8192du/include/Hal8192DPhyCfg.h
+++ b/drivers/staging/rtl8192du/include/Hal8192DPhyCfg.h
@@ -211,27 +211,6 @@ struct bb_register_def {
 	u32 rfLSSIReadBackPi;	//LSSI RF readback data PI mode 0x8b8-8bc for Path A and B
 };
 
-#ifdef CONFIG_MP_INCLUDED
-enum ANTENNA_PATH {
-        ANTENNA_NONE	= 0x00,
-	ANTENNA_D,
-	ANTENNA_C,
-	ANTENNA_CD,
-	ANTENNA_B,
-	ANTENNA_BD,
-	ANTENNA_BC,
-	ANTENNA_BCD,
-	ANTENNA_A,
-	ANTENNA_AD,
-	ANTENNA_AC,
-	ANTENNA_ACD,
-	ANTENNA_AB,
-	ANTENNA_ABD,
-	ANTENNA_ABC,
-	ANTENNA_ABCD
-};
-#endif
-
 struct antenna_select_ofdm {
 	u32			r_tx_antenna:4;
 	u32			r_ant_l:4;
--- a/drivers/staging/rtl8192du/include/autoconf.h
+++ b/drivers/staging/rtl8192du/include/autoconf.h
@@ -59,20 +59,8 @@
 
 #define CONFIG_RECV_REORDERING_CTRL	1
 
-//#define CONFIG_TCP_CSUM_OFFLOAD_RX	1
-
-//#define CONFIG_DRVEXT_MODULE	1
-
-//#define CONFIG_DEINIT_BEFORE_INIT	1
-
-#ifndef CONFIG_MP_INCLUDED
-	#define CONFIG_IPS	1
-	#define CONFIG_LPS	1
-	//#define CONFIG_BT_COEXIST	1
-	//#define SUPPORT_HW_RFOFF_DETECTED	1
-#else
-	#define CONFIG_MP_IWPRIV_SUPPORT 1
-#endif
+#define CONFIG_IPS	1
+#define CONFIG_LPS	1
 
 #define CONFIG_AP_MODE 1
 #ifdef CONFIG_AP_MODE
@@ -81,7 +69,6 @@
 		#define CONFIG_HOSTAPD_MLME	1
 	#endif
 	#define CONFIG_FIND_BEST_CHANNEL	1
-	//#define CONFIG_NO_WIRELESS_HANDLERS	1
 #endif
 
 //	Added by Albert 20110314
@@ -216,13 +203,7 @@
 
 #define FW_PROCESS_VENDOR_CMD 1
 
-#ifdef CONFIG_MP_INCLUDED
-	#define MP_DRIVER 1
-	#undef CONFIG_USB_TX_AGGREGATION
-	#undef CONFIG_USB_RX_AGGREGATION
-#else
-	#define MP_DRIVER 0
-#endif
+#define MP_DRIVER 0
 
 /*
  * Debug  Related Config
--- a/drivers/staging/rtl8192du/include/drv_types.h
+++ b/drivers/staging/rtl8192du/include/drv_types.h
@@ -66,10 +66,6 @@ enum {
 #include <drvext_api.h>
 #endif
 
-#ifdef CONFIG_MP_INCLUDED
-#include <rtw_mp.h>
-#endif
-
 #ifdef CONFIG_BR_EXT
 #include <rtw_br_ext.h>
 #endif	// CONFIG_BR_EXT
@@ -318,10 +314,6 @@ struct rtw_adapter {
 	struct	eeprom_priv eeprompriv;
 	struct	led_priv	ledpriv;
 
-#ifdef CONFIG_MP_INCLUDED
-       struct	mp_priv	mppriv;
-#endif
-
 #ifdef CONFIG_DRVEXT_MODULE
 	struct	drvext_priv	drvextpriv;
 #endif
--- a/drivers/staging/rtl8192du/include/rtl8192d_hal.h
+++ b/drivers/staging/rtl8192du/include/rtl8192d_hal.h
@@ -723,41 +723,7 @@ void rtl8192d_ResetDualMacSwitchVariable
 u8 GetEEPROMSize8192D(struct rtw_adapter * Adapter);
 bool PHY_CheckPowerOffFor8192D(struct rtw_adapter * Adapter);
 void PHY_SetPowerOnFor8192D(struct rtw_adapter * Adapter);
-//void PHY_ConfigMacPhyMode92D(struct rtw_adapter * Adapter);
 void rtl8192d_free_hal_data(struct rtw_adapter *padapter);
 void rtl8192d_set_hal_ops(struct hal_ops *pHalFunc);
 
 #endif
-
-#ifdef CONFIG_MP_INCLUDED
-
-
-extern void Hal_SetAntenna(struct rtw_adapter * pAdapter);
-extern void Hal_SetBandwidth(struct rtw_adapter * pAdapter);
-
-extern void Hal_SetTxPower(struct rtw_adapter * pAdapter);
-extern void Hal_SetCarrierSuppressionTx(struct rtw_adapter * pAdapter, u8 bStart);
-extern void Hal_SetSingleToneTx (struct rtw_adapter * pAdapter , u8 bStart);
-extern void Hal_SetSingleCarrierTx (struct rtw_adapter * pAdapter, u8 bStart);
-extern void Hal_SetContinuousTx (struct rtw_adapter * pAdapter, u8 bStart);
-extern void Hal_SetBandwidth(struct rtw_adapter * pAdapter);
-
-extern void Hal_SetDataRate(struct rtw_adapter * pAdapter);
-extern void Hal_SetChannel(struct rtw_adapter * pAdapter);
-extern void Hal_SetAntennaPathPower(struct rtw_adapter * pAdapter);
-extern s32 Hal_SetThermalMeter(struct rtw_adapter * pAdapter, u8 target_ther);
-extern s32 Hal_SetPowerTracking(struct rtw_adapter * padapter, u8 enable);
-extern void Hal_GetPowerTracking(struct rtw_adapter * padapter, u8 *enable);
-extern void Hal_GetThermalMeter(struct rtw_adapter * pAdapter, u8 *value);
-extern void Hal_mpt_SwitchRfSetting(struct rtw_adapter * pAdapter);
-extern void Hal_MPT_CCKTxPowerAdjust(struct rtw_adapter * Adapter, bool bInCH14);
-extern void Hal_MPT_CCKTxPowerAdjustbyIndex(struct rtw_adapter * pAdapter, bool beven);
-extern void Hal_SetCCKTxPower(struct rtw_adapter * pAdapter, u8 *TxPower);
-extern void Hal_SetOFDMTxPower(struct rtw_adapter * pAdapter, u8 *TxPower);
-extern void Hal_TriggerRFThermalMeter(struct rtw_adapter * pAdapter);
-extern u8 Hal_ReadRFThermalMeter(struct rtw_adapter * pAdapter);
-extern void Hal_SetCCKContinuousTx(struct rtw_adapter * pAdapter, u8 bStart);
-extern void Hal_SetOFDMContinuousTx(struct rtw_adapter * pAdapter, u8 bStart);
-
-
-#endif //end CONFIG_MP_INCLUDED
--- a/drivers/staging/rtl8192du/include/rtw_ioctl.h
+++ b/drivers/staging/rtl8192du/include/rtw_ioctl.h
@@ -102,16 +102,6 @@ struct oid_obj_priv {
 	uint (*oidfuns)(struct oid_par_priv *poid_par_priv);
 };
 
-#if (defined(CONFIG_MP_INCLUDED) && defined(_RTW_MP_IOCTL_C_))
-static uint oid_null_function(struct oid_par_priv* poid_par_priv)
-{
-	_func_enter_;
-	_func_exit_;
-	return uint_SUCCESS;
-}
-#endif
-
-
 #if defined(CONFIG_WIRELESS_EXT)
 extern struct iw_handler_def  rtw_handlers_def;
 #endif
--- a/drivers/staging/rtl8192du/os_dep/ioctl_cfg80211.c
+++ b/drivers/staging/rtl8192du/os_dep/ioctl_cfg80211.c
@@ -1797,14 +1797,6 @@ static int cfg80211_rtw_scan(struct wiph
 	}
 #endif //CONFIG_CONCURRENT_MODE
 
-#ifdef CONFIG_MP_INCLUDED
-	if (check_fwstate(pmlmepriv, WIFI_MP_STATE) == true)
-	{
-		ret = -EPERM;
-		goto exit;
-	}
-#endif
-
 	spin_lock_bh(&pwdev_priv->scan_req_lock);
 	pwdev_priv->scan_request = request;
 	spin_unlock_bh(&pwdev_priv->scan_req_lock);
--- a/drivers/staging/rtl8192du/os_dep/ioctl_linux.c
+++ b/drivers/staging/rtl8192du/os_dep/ioctl_linux.c
@@ -30,16 +30,10 @@
 #include <rtw_ioctl.h>
 #include <rtw_ioctl_set.h>
 
-//#ifdef CONFIG_MP_INCLUDED
 #include <rtw_mp_ioctl.h>
-//#endif
 
 #include <usb_ops.h>
 
-#ifdef CONFIG_MP_INCLUDED
-#include <rtw_mp.h>
-#endif
-
 #if (LINUX_VERSION_CODE < KERNEL_VERSION(2,6,27))
 #define  iwe_stream_add_event(a, b, c, d, e)  iwe_stream_add_event(b, c, d, e)
 #define  iwe_stream_add_point(a, b, c, d, e)  iwe_stream_add_point(b, c, d, e)
@@ -1694,23 +1688,6 @@ _func_enter_;
 	#ifdef DBG_IOCTL
 	DBG_8192D("DBG_IOCTL %s:%d\n",__func__, __LINE__);
 	#endif
-/*
-#ifdef CONFIG_CONCURRENT_MODE
-	if (padapter->iface_type > PRIMARY_IFACE)
-	{
-		ret = -1;
-		goto exit;
-	}
-#endif
-*/
-
-#ifdef CONFIG_MP_INCLUDED
-	if (check_fwstate(pmlmepriv, WIFI_MP_STATE) == true)
-	{
-		ret = -1;
-		goto exit;
-	}
-#endif
 
 	if (_FAIL == rtw_pwr_wakeup(padapter))
 	{
@@ -3404,58 +3381,8 @@ static int rtw_mp_ioctl_hdl(struct net_d
 		ret = -EINVAL;
 		goto _rtw_mp_ioctl_hdl_exit;
 	}
-
-	//DBG_8192D("%s: %d\n", __func__, poidparam->subcode);
-
-#ifdef CONFIG_MP_INCLUDED
-	phandler = mp_ioctl_hdl + poidparam->subcode;
-
-	if ((phandler->paramsize != 0) && (poidparam->len < phandler->paramsize))
-	{
-		RT_TRACE(_module_rtl871x_ioctl_os_c, _drv_err_,
-			 ("no matching drvext param size %d vs %d\r\n",
-			  poidparam->len, phandler->paramsize));
-		ret = -EINVAL;
-		goto _rtw_mp_ioctl_hdl_exit;
-	}
-
-	if (phandler->handler)
-	{
-		oid_par.adapter_context = padapter;
-		oid_par.oid = phandler->oid;
-		oid_par.information_buf = poidparam->data;
-		oid_par.information_buf_len = poidparam->len;
-		oid_par.dbg = 0;
-
-		BytesWritten = 0;
-		BytesNeeded = 0;
-
-		if (bset) {
-			oid_par.bytes_rw = &BytesRead;
-			oid_par.bytes_needed = &BytesNeeded;
-			oid_par.type_of_oid = SET_OID;
-		} else {
-			oid_par.bytes_rw = &BytesWritten;
-			oid_par.bytes_needed = &BytesNeeded;
-			oid_par.type_of_oid = QUERY_OID;
-		}
-
-		status = phandler->handler(&oid_par);
-
-		//todo:check status, BytesNeeded, etc.
-	}
-	else {
-		DBG_8192D("rtw_mp_ioctl_hdl(): err!, subcode=%d, oid=%d, handler=%p\n",
-			poidparam->subcode, phandler->oid, phandler->handler);
-		ret = -EFAULT;
-		goto _rtw_mp_ioctl_hdl_exit;
-	}
-#else
-
 	rtw_dbg_mode_hdl(padapter, poidparam->subcode, poidparam->data, poidparam->len);
 
-#endif
-
 	if (bset == 0x00) {//query info
 		if (copy_to_user(p->pointer, pparmbuf, len))
 			ret = -EFAULT;
@@ -8144,1114 +8071,6 @@ static int rtw_mp_efuse_set(struct net_d
 	  return 0;
 }
 
-
-
-#if defined(CONFIG_MP_INCLUDED) && defined(CONFIG_MP_IWPRIV_SUPPORT)
-
-/*
- * Input Format: %s,%d,%d
- *	%s is width, could be
- *		"b" for 1 byte
- *		"w" for WORD (2 bytes)
- *		"dw" for DWORD (4 bytes)
- *	1st %d is address(offset)
- *	2st %d is data to write
- */
-static int rtw_mp_write_reg(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	char *pch, *pnext, *ptmp;
-	char *width_str;
-	char width;
-	u32 addr, data;
-	int ret;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	pch = extra;
-	pnext = strpbrk(pch, " ,.-");
-	if (pnext == NULL) return -EINVAL;
-	*pnext = 0;
-	width_str = pch;
-
-	pch = pnext + 1;
-	pnext = strpbrk(pch, " ,.-");
-	if (pnext == NULL) return -EINVAL;
-	*pnext = 0;
-	addr = simple_strtoul(pch, &ptmp, 16);
-	if (addr > 0x3FFF) return -EINVAL;
-
-	pch = pnext + 1;
-	if ((pch - extra) >= wrqu->length) return -EINVAL;
-	data = simple_strtoul(pch, &ptmp, 16);
-
-	ret = 0;
-	width = width_str[0];
-	switch (width) {
-		case 'b':
-			// 1 byte
-			if (data > 0xFF) {
-				ret = -EINVAL;
-				break;
-			}
-			rtw_write8(padapter, addr, data);
-			break;
-		case 'w':
-			// 2 bytes
-			if (data > 0xFFFF) {
-				ret = -EINVAL;
-				break;
-			}
-			rtw_write16(padapter, addr, data);
-			break;
-		case 'd':
-			// 4 bytes
-			rtw_write32(padapter, addr, data);
-			break;
-		default:
-			ret = -EINVAL;
-			break;
-	}
-
-	return ret;
-}
-
-/*
- * Input Format: %s,%d
- *	%s is width, could be
- *		"b" for 1 byte
- *		"w" for WORD (2 bytes)
- *		"dw" for DWORD (4 bytes)
- *	%d is address(offset)
- *
- * Return:
- *	%d for data readed
- */
-static int rtw_mp_read_reg(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	char input[wrqu->length];
-	char *pch, *pnext, *ptmp;
-	char *width_str;
-	char width;
-	char data[20],tmp[20];
-	u32 addr;
-	//u32 *data = (u32*)extra;
-	u32 ret, i=0, j=0, strtout=0;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (wrqu->length > 128) return -EFAULT;
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-		return -EFAULT;
-
-	memset(data, 0, 20);
-	memset(tmp, 0, 20);
-	memset(extra, 0, wrqu->length);
-
-	pch = input;
-	pnext = strpbrk(pch, " ,.-");
-	if (pnext == NULL) return -EINVAL;
-	*pnext = 0;
-	width_str = pch;
-
-	pch = pnext + 1;
-	if ((pch - input) >= wrqu->length) return -EINVAL;
-
-	addr = simple_strtoul(pch, &ptmp, 16);
-	if (addr > 0x3FFF) return -EINVAL;
-
-	ret = 0;
-	width = width_str[0];
-	switch (width) {
-		case 'b':
-			// 1 byte
-			// *(u8*)data = rtw_read8(padapter, addr);
-			sprintf(extra, "%d\n",  rtw_read8(padapter, addr));
-			wrqu->length = strlen(extra);
-			break;
-		case 'w':
-			// 2 bytes
-			//*(u16*)data = rtw_read16(padapter, addr);
-			sprintf(data, "%04d\n", rtw_read16(padapter, addr));
-			for (i=0 ; i <= strlen(data) ; i++)
-				{
-					  if (i%2==0)
-					  {
-						   tmp[j]=' ';
-						   j++;
-					  }
-					  if (data[i] != '\0')
-						 tmp[j] = data[i];
-
-						 j++;
-				}
-				pch = tmp;
-				DBG_8192D("pch=%s",pch);
-
-				while (*pch != '\0')
-				{
-					pnext = strpbrk(pch, " ");
-					pnext++;
-					if (*pnext != '\0')
-					{
-						  strtout = simple_strtoul (pnext , &ptmp, 16);
-						  sprintf(extra, "%s %d" ,extra ,strtout);
-					}
-					else {
-						  break;
-					}
-					pch = pnext;
-				}
-			wrqu->length = 6;
-			break;
-		case 'd':
-			// 4 bytes
-			//*data = rtw_read32(padapter, addr);
-			sprintf(data, "%08x", rtw_read32(padapter, addr));
-				//add read data format blank
-				for (i=0 ; i <= strlen(data) ; i++)
-				{
-					  if (i%2==0)
-					  {
-						   tmp[j]=' ';
-						   j++;
-					  }
-					  tmp[j] = data[i];
-					  j++;
-				}
-				pch = tmp;
-				DBG_8192D("pch=%s",pch);
-
-				while (*pch != '\0')
-				{
-					pnext = strpbrk(pch, " ");
-					pnext++;
-					if (*pnext != '\0')
-					{
-						  strtout = simple_strtoul (pnext , &ptmp, 16);
-						  sprintf(extra, "%s %d" ,extra ,strtout);
-					}
-					else {
-			break;
-					}
-					pch = pnext;
-				}
-			wrqu->length = strlen(extra);
-			break;
-
-		default:
-			wrqu->length = 0;
-			ret = -EINVAL;
-			break;
-
-	}
-
-	return ret;
-}
-
-/*
- * Input Format: %d,%x,%x
- *	%d is RF path, should be smaller than MAX_RF_PATH_NUMS
- *	1st %x is address(offset)
- *	2st %x is data to write
- */
- static int rtw_mp_write_rf(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-/*static int rtw_mp_write_rf(struct net_device *dev,
-			struct iw_request_info *info,
-			union iwreq_data *wrqu, char *extra)
-*/
-	u32 path, addr, data;
-	int ret;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	ret = sscanf(extra, "%d,%x,%x", &path, &addr, &data);
-	if (ret < 3) return -EINVAL;
-
-	if (path >= MAX_RF_PATH_NUMS) return -EINVAL;
-	if (addr > 0xFF) return -EINVAL;
-	if (data > 0xFFFFF) return -EINVAL;
-	memset(extra, 0, wrqu->length);
-
-	write_rfreg(padapter, path, addr, data);
-
-	sprintf(extra, "write_rf completed\n");
-
-	return 0;
-}
-
-/*
- * Input Format: %d,%x
- *	%d is RF path, should be smaller than MAX_RF_PATH_NUMS
- *	%x is address(offset)
- *
- * Return:
- *	%d for data readed
- */
-static int rtw_mp_read_rf(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	char input[wrqu->length];
-	char *pch, *pnext, *ptmp;
-	char data[20],tmp[20];
-	//u32 *data = (u32*)extra;
-	u32 path, addr;
-	u32 ret,i=0 ,j=0,strtou=0;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	if (wrqu->length > 128) return -EFAULT;
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-		return -EFAULT;
-
-	ret = sscanf(input, "%d,%x", &path, &addr);
-	if (ret < 2) return -EINVAL;
-
-	if (path >= MAX_RF_PATH_NUMS) return -EINVAL;
-	if (addr > 0xFF) return -EINVAL;
-
-	memset(extra, 0, wrqu->length);
-
-	//*data = read_rfreg(padapter, path, addr);
-	sprintf(data, "%08x", read_rfreg(padapter, path, addr));
-				//add read data format blank
-				for (i=0 ; i <= strlen(data) ; i++)
-				{
-					  if (i%2==0)
-					  {
-						   tmp[j]=' ';
-						   j++;
-					  }
-					  tmp[j] = data[i];
-					  j++;
-				}
-				pch = tmp;
-				DBG_8192D("pch=%s",pch);
-
-				while (*pch != '\0')
-				{
-					pnext = strpbrk(pch, " ");
-					pnext++;
-					if (*pnext != '\0')
-					{
-						  strtou = simple_strtoul (pnext , &ptmp, 16);
-						  sprintf(extra, "%s %d" ,extra ,strtou);
-					}
-					else {
-						  break;
-					}
-					pch = pnext;
-				}
-			wrqu->length = strlen(extra);
-
-	return 0;
-}
-
-static int rtw_mp_start(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 val8;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	if (padapter->registrypriv.mp_mode == 0)
-		return -EPERM;
-
-	if (padapter->mppriv.mode == MP_OFF) {
-		if (mp_start_test(padapter) == _FAIL)
-			return -EPERM;
-		padapter->mppriv.mode = MP_ON;
-	}
-
-	return 0;
-}
-
-static int rtw_mp_stop(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	if (padapter->mppriv.mode != MP_OFF) {
-		mp_stop_test(padapter);
-		padapter->mppriv.mode = MP_OFF;
-	}
-
-	return 0;
-}
-
-extern int wifirate2_ratetbl_inx(unsigned char rate);
-
-static int rtw_mp_rate(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u32 rate = MPT_RATE_1M;
-	u8		input[wrqu->length];
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	rate = rtw_atoi(input);
-	sprintf(extra, "Set data rate to %d" , rate);
-
-	if (rate <= 0x7f)
-		rate = wifirate2_ratetbl_inx((u8)rate);
-	else
-		rate =(rate-0x80+MPT_RATE_MCS0);
-
-	//DBG_8192D("%s: rate=%d\n", __func__, rate);
-
-	if (rate >= MPT_RATE_LAST)
-	return -EINVAL;
-
-	padapter->mppriv.rateidx = rate;
-	Hal_SetDataRate(padapter);
-
-	wrqu->length = strlen(extra) + 1;
-	return 0;
-}
-
-static int rtw_mp_channel(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	u8		input[wrqu->length];
-	u32	channel = 1;
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	channel = rtw_atoi(input);
-	//DBG_8192D("%s: channel=%d\n", __func__, channel);
-	sprintf(extra, "Change channel %d to channel %d", padapter->mppriv.channel , channel);
-
-	padapter->mppriv.channel = channel;
-	Hal_SetChannel(padapter);
-
-	wrqu->length = strlen(extra) + 1;
-	return 0;
-}
-
-static int rtw_mp_bandwidth(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u32 bandwidth=0, sg=0;
-	//u8 buffer[40];
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	//if (copy_from_user(buffer, (void*)wrqu->data.pointer, wrqu->data.length))
-    //            return -EFAULT;
-
-	//DBG_8192D("%s:iwpriv in=%s\n", __func__, extra);
-
-	sscanf(extra, "40M=%d,shortGI=%d", &bandwidth, &sg);
-
-	if (bandwidth != HT_CHANNEL_WIDTH_40)
-		bandwidth = HT_CHANNEL_WIDTH_20;
-
-	//DBG_8192D("%s: bw=%d sg=%d\n", __func__, bandwidth , sg);
-
-	padapter->mppriv.bandwidth = (u8)bandwidth;
-	padapter->mppriv.preamble = sg;
-
-	SetBandwidth(padapter);
-
-	return 0;
-}
-
-static int rtw_mp_txpower(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u32		idx_a=0,idx_b=0;
-	u8		input[wrqu->length];
-
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	sscanf(input,"patha=%d,pathb=%d",&idx_a,&idx_b);
-	//DBG_8192D("%s: tx_pwr_idx_a=%x b=%x\n", __func__, idx_a, idx_b);
-
-	sprintf(extra, "Set power level path_A:%d path_B:%d", idx_a , idx_b);
-	padapter->mppriv.txpoweridx = (u8)idx_a;
-	padapter->mppriv.txpoweridx_b = (u8)idx_b;
-
-	Hal_SetAntennaPathPower(padapter);
-
-	wrqu->length = strlen(extra) + 1;
-	return 0;
-}
-
-static int rtw_mp_ant_tx(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 i;
-	u8		input[wrqu->length];
-	u16 antenna = 0;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	//DBG_8192D("%s: input=%s\n", __func__, input);
-
-	sprintf(extra, "switch Tx antenna to %s", input);
-
-	for (i=0; i < strlen(input); i++)
-	{
-		switch (input[i])
-			{
-				case 'a' :
-								antenna|=ANTENNA_A;
-								break;
-				case 'b':
-								antenna|=ANTENNA_B;
-								break;
-			}
-	}
-	//antenna |= BIT(extra[i]-'a');
-	//DBG_8192D("%s: antenna=0x%x\n", __func__, antenna);
-	padapter->mppriv.antenna_tx = antenna;
-	//DBG_8192D("%s:mppriv.antenna_rx=%d\n", __func__, padapter->mppriv.antenna_tx);
-
-	Hal_SetAntenna(padapter);
-
-	wrqu->length = strlen(extra) + 1;
-	return 0;
-}
-
-static int rtw_mp_ant_rx(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 i;
-	u16 antenna = 0;
-	u8		input[wrqu->length];
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-	//DBG_8192D("%s: input=%s\n", __func__, input);
-	memset(extra, 0, wrqu->length);
-
-	sprintf(extra, "switch Rx antenna to %s", input);
-
-	for (i=0; i < strlen(input); i++) {
-
-	switch (input[i])
-			{
-				case 'a' :
-								antenna|=ANTENNA_A;
-								break;
-				case 'b':
-								antenna|=ANTENNA_B;
-								break;
-			}
-	}
-
-	//DBG_8192D("%s: antenna=0x%x\n", __func__, antenna);
-	padapter->mppriv.antenna_rx = antenna;
-	//DBG_8192D("%s:mppriv.antenna_rx=%d\n", __func__, padapter->mppriv.antenna_rx);
-	Hal_SetAntenna(padapter);
-	wrqu->length = strlen(extra);
-
-	return 0;
-}
-
-static int rtw_mp_ctx(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u32 pkTx = 1, countPkTx = 1, cotuTx = 1, CarrSprTx = 1, scTx = 1, sgleTx = 1, stop = 1;
-	u32 bStartTest = 1;
-	u32 count = 0;
-	struct mp_priv *pmp_priv;
-	struct pkt_attrib *pattrib;
-
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-
-	pmp_priv = &padapter->mppriv;
-
-	if (copy_from_user(extra, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	DBG_8192D("%s: in=%s\n", __func__, extra);
-
-	countPkTx = strncmp(extra, "count=", 5); // strncmp TRUE is 0
-	cotuTx = strncmp(extra, "background", 20);
-	CarrSprTx = strncmp(extra, "background,cs", 20);
-	scTx = strncmp(extra, "background,sc", 20);
-	sgleTx = strncmp(extra, "background,stone", 20);
-	pkTx = strncmp(extra, "background,pkt", 20);
-	stop = strncmp(extra, "stop", 5);
-	sscanf(extra, "count=%d,pkt", &count);
-
-	//DBG_8192D("%s: count=%d countPkTx=%d cotuTx=%d CarrSprTx=%d scTx=%d sgleTx=%d pkTx=%d stop=%d\n", __func__, count, countPkTx, cotuTx, CarrSprTx, pkTx, sgleTx, scTx, stop);
-	memset(extra, '\0', sizeof(extra));
-
-	if (stop == 0) {
-		bStartTest = 0; // To set Stop
-		pmp_priv->tx.stop = 1;
-		sprintf(extra, "Stop continuous Tx");
-	} else {
-		bStartTest = 1;
-		if (pmp_priv->mode != MP_ON) {
-			if (pmp_priv->tx.stop != 1) {
-				DBG_8192D("%s: MP_MODE != ON %d\n", __func__, pmp_priv->mode);
-				return  -EFAULT;
-			}
-		}
-	}
-
-	if (pkTx == 0 || countPkTx == 0)
-		pmp_priv->mode = MP_PACKET_TX;
-	if (sgleTx == 0)
-		pmp_priv->mode = MP_SINGLE_TONE_TX;
-	if (cotuTx == 0)
-		pmp_priv->mode = MP_CONTINUOUS_TX;
-	if (CarrSprTx == 0)
-		pmp_priv->mode = MP_CARRIER_SUPPRISSION_TX;
-	if (scTx == 0)
-		pmp_priv->mode = MP_SINGLE_CARRIER_TX;
-
-	switch (pmp_priv->mode)
-	{
-		case MP_PACKET_TX:
-
-			//DBG_8192D("%s:pkTx %d\n", __func__,bStartTest);
-			if (bStartTest == 0)
-			{
-				pmp_priv->tx.stop = 1;
-				pmp_priv->mode = MP_ON;
-				sprintf(extra, "Stop continuous Tx");
-			}
-			else if (pmp_priv->tx.stop == 1)
-			{
-				sprintf(extra, "Start continuous DA=ffffffffffff len=1500 count=%u,\n",count);
-				//DBG_8192D("%s:countPkTx %d\n", __func__,count);
-				pmp_priv->tx.stop = 0;
-				pmp_priv->tx.count = count;
-				pmp_priv->tx.payload = 2;
-				pattrib = &pmp_priv->tx.attrib;
-				pattrib->pktlen = 1460;
-				memset(pattrib->dst, 0xFF, ETH_ALEN);
-				SetPacketTx(padapter);
-			}
-			else {
-				//DBG_8192D("%s: pkTx not stop\n", __func__);
-				return -EFAULT;
-			}
-				wrqu->length = strlen(extra);
-				return 0;
-
-		case MP_SINGLE_TONE_TX:
-			//DBG_8192D("%s: sgleTx %d\n", __func__, bStartTest);
-			if (bStartTest != 0) {
-				sprintf(extra, "Start continuous DA=ffffffffffff len=1500\n infinite=yes.");
-
-			 }
-			Hal_SetSingleToneTx(padapter, (u8)bStartTest);
-			break;
-
-		case MP_CONTINUOUS_TX:
-			DBG_8192D("%s: cotuTx %d\n", __func__, bStartTest);
-			if (bStartTest != 0) {
-				sprintf(extra, "Start continuous DA=ffffffffffff len=1500\n infinite=yes.");
-			 }
-			 Hal_SetContinuousTx(padapter, (u8)bStartTest);
-			break;
-
-		case MP_CARRIER_SUPPRISSION_TX:
-			//DBG_8192D("%s: CarrSprTx %d\n", __func__, bStartTest);
-			if (bStartTest != 0) {
-				if (pmp_priv->rateidx <= MPT_RATE_11M)
-				{
-					sprintf(extra, "Start continuous DA=ffffffffffff len=1500\n infinite=yes.");
-				} else
-					sprintf(extra, "Specify carrier suppression but not CCK rate");
-			}
-			Hal_SetCarrierSuppressionTx(padapter, (u8)bStartTest);
-			break;
-
-		case MP_SINGLE_CARRIER_TX:
-			//DBG_8192D("%s: scTx %d\n", __func__, bStartTest);
-			if (bStartTest != 0) {
-				sprintf(extra, "Start continuous DA=ffffffffffff len=1500\n infinite=yes.");
-			}
-			Hal_SetSingleCarrierTx(padapter, (u8)bStartTest);
-			break;
-
-		default:
-			//DBG_8192D("%s:No Match MP_MODE\n", __func__);
-			sprintf(extra, "Error! Continuous-Tx is not on-going.");
-			return -EFAULT;
-	}
-
-	if (bStartTest) {
-		struct mp_priv *pmp_priv = &padapter->mppriv;
-		if (pmp_priv->tx.stop == 0) {
-			pmp_priv->tx.stop = 1;
-			//DBG_8192D("%s: pkt tx is running...\n", __func__);
-			rtw_msleep_os(5);
-		}
-		pmp_priv->tx.stop = 0;
-		pmp_priv->tx.count = 1;
-		SetPacketTx(padapter);
-	} else {
-		pmp_priv->mode = MP_ON;
-	}
-
-	wrqu->length = strlen(extra);
-	return 0;
-}
-
-static int rtw_mp_arx(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 bStartRx=0,bStopRx=0;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	u8		input[wrqu->length];
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	DBG_8192D("%s: %s\n", __func__, input);
-
-	bStartRx = (strncmp(input, "start", 5)==0)?1:0; // strncmp TRUE is 0
-	bStopRx = (strncmp(input, "stop", 5)==0)?1:0; // strncmp TRUE is 0
-	SetPacketRx(padapter, bStartRx);
-
-	if (bStartRx)
-	{
-		sprintf(extra, "start");
-		wrqu->length = strlen(extra) + 1;
-	}
-	else if (bStopRx)
-	{
-		sprintf(extra, "Received packet OK:%d CRC error:%d",padapter->mppriv.rx_pktcount,
-														padapter->mppriv.rx_crcerrpktcount);
-		wrqu->length = strlen(extra) + 1;
-	}
-
-
-	return 0;
-}
-
-static int rtw_mp_trx_query(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u32 txok,txfail,rxok,rxfail;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	//if (copy_from_user(extra, wrqu->data.pointer, wrqu->data.length))
-	//	return -EFAULT;
-
-	txok=padapter->mppriv.tx.sended;
-	txfail=0;
-	rxok = padapter->mppriv.rx_pktcount;
-	rxfail = padapter->mppriv.rx_crcerrpktcount;
-
-	memset(extra, '\0', 128);
-
-	sprintf(extra, "Tx OK:%d, Tx Fail:%d, Rx OK:%d, CRC error:%d ", txok, txfail,rxok,rxfail);
-
-	wrqu->length=strlen(extra)+1;
-
-	return 0;
-}
-
-static int rtw_mp_pwrtrk(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 enable;
-	u32 thermal;
-	s32 ret;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	u8		input[wrqu->length];
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	memset(extra, 0, wrqu->length);
-
-	enable = 1;
-	if (wrqu->length > 1) { // not empty string
-		if (strncmp(input, "stop", 4) == 0)
-		{
-			enable = 0;
-			sprintf(extra, "mp tx power tracking stop");
-		}
-		else if (sscanf(input, "ther=%d", &thermal)) {
-				ret = Hal_SetThermalMeter(padapter, (u8)thermal);
-				if (ret == _FAIL) return -EPERM;
-				sprintf(extra, "mp tx power tracking start,target value=%d ok ",thermal);
-		} else	{
-			return -EINVAL;
-		}
-	}
-
-	ret = Hal_SetPowerTracking(padapter, enable);
-	if (ret == _FAIL) return -EPERM;
-
-	wrqu->length = strlen(extra);
-
-	return 0;
-}
-
-static int rtw_mp_psd(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	u8		input[wrqu->length];
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-		return -EFAULT;
-
-	strcpy(extra,input);
-
-	wrqu->length = mp_query_psd(padapter, extra);
-
-	return 0;
-}
-
-static int rtw_mp_thermal(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	u8 val;
-	u16 bwrite=1;
-	u16 addr=0xc3;
-	u16 cnt=1;
-	u16 max_available_size=0;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (copy_from_user(extra, wrqu->pointer, wrqu->length))
-		return -EFAULT;
-
-	 bwrite = strncmp(extra, "write", 6); // strncmp TRUE is 0
-
-	 Hal_GetThermalMeter(padapter, &val);
-
-	 if (bwrite == 0) {
-		EFUSE_GetEfuseDefinition(padapter, EFUSE_WIFI, TYPE_AVAILABLE_EFUSE_BYTES_TOTAL, (void *)&max_available_size, false);
-		if (2 > max_available_size) {
-			DBG_8192D("no available efuse!\n");
-			return -EFAULT;
-		}
-		if (rtw_efuse_map_write(padapter, addr, cnt, &val) == _FAIL) {
-			DBG_8192D("rtw_efuse_map_write error\n");
-			return -EFAULT;
-		} else {
-			sprintf(extra, " efuse write ok :%d", val);
-		}
-	} else {
-		sprintf(extra, "%d", val);
-	}
-	wrqu->length = strlen(extra);
-	return 0;
-}
-
-static int rtw_mp_reset_stats(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	struct mp_priv *pmp_priv;
-	struct pkt_attrib *pattrib;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	pmp_priv = &padapter->mppriv;
-
-	pmp_priv->tx.sended = 0;
-	padapter->mppriv.rx_pktcount = 0;
-	padapter->mppriv.rx_crcerrpktcount = 0;
-
-	return 0;
-}
-
-static int rtw_mp_dump(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-	struct mp_priv *pmp_priv;
-	struct pkt_attrib *pattrib;
-        u32 value;
-	u8 rf_type,path_nums = 0;
-	u32 i,j=1,path;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	pmp_priv = &padapter->mppriv;
-
-
-	//if (copy_from_user(extra, wrqu->data.pointer, wrqu->data.length))
-	//	return -EFAULT;
-
-	if (strncmp(extra, "all", 4)==0)
-	{
-			DBG_8192D("\n======= MAC REG =======\n");
-			for (i=0x0;i<0x300;i+=4)
-			{
-				if (j%4==1)	DBG_8192D("0x%02x",i);
-				DBG_8192D(" 0x%08x ",rtw_read32(padapter,i));
-				if ((j++)%4 == 0)	DBG_8192D("\n");
-			}
-			for (i=0x400;i<0x800;i+=4)
-			{
-				if (j%4==1)	DBG_8192D("0x%02x",i);
-				DBG_8192D(" 0x%08x ",rtw_read32(padapter,i));
-				if ((j++)%4 == 0)	DBG_8192D("\n");
-			}
-
-			i,j=1;
-			rtw_hal_get_hwreg(padapter, HW_VAR_RF_TYPE, (u8 *)(&rf_type));
-
-			DBG_8192D("\n======= RF REG =======\n");
-			if ((RF_1T2R == rf_type) ||(RF_1T1R ==rf_type))
-				path_nums = 1;
-			else
-				path_nums = 2;
-
-			for (path=0;path<path_nums;path++) {
-				for (i = 0; i < 0x50; i++) {
-					value =rtw_hal_read_rfreg(padapter, path, i, 0xffffffff);
-					if (j%4==1)
-						DBG_8192D("0x%02x ",i);
-					DBG_8192D(" 0x%08x ",value);
-					if ((j++)%4==0)
-						DBG_8192D("\n");
-				}
-			}
-	}
-	return 0;
-}
-
-static int rtw_mp_phypara(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-	char	input[wrqu->length];
-	u32		valxcap;
-
-	if (copy_from_user(input, wrqu->pointer, wrqu->length))
-			return -EFAULT;
-
-	DBG_8192D("%s:iwpriv in=%s\n", __func__, input);
-
-	sscanf(input, "xcap=%d", &valxcap);
-
-	if (!IS_HARDWARE_TYPE_8192D(padapter))
-			return 0;
-	Hal_ProSetCrystalCap(padapter , valxcap);
-
-	sprintf(extra, "Set xcap=%d",valxcap);
-	wrqu->length = strlen(extra) + 1;
-
-return 0;
-}
-
-
-/* update Tx AGC offset */
-static int rtw_mp_antBdiff(struct net_device *dev,
-			struct iw_request_info *info,
-			struct iw_point *wrqu, char *extra)
-{
-
-
-	// MPT_ProSetTxAGCOffset
-	return 0;
-}
-
-
-static int rtw_mp_set(struct net_device *dev,
-			struct iw_request_info *info,
-			union iwreq_data *wdata, char *extra)
-{
-	struct iw_point *wrqu = (struct iw_point *)wdata;
-	u32 subcmd = wrqu->flags;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	if (padapter == NULL)
-	{
-		return -ENETDOWN;
-	}
-
-	//memset(extra, 0x00, IW_PRIV_SIZE_MASK);
-
-	if (extra == NULL)
-	{
-		wrqu->length = 0;
-		return -EIO;
-	}
-
-	switch (subcmd)
-	{
-	case WRITE_REG :
-			rtw_mp_write_reg (dev,info,wrqu,extra);
-			 break;
-
-	case WRITE_RF:
-			rtw_mp_write_rf (dev,info,wrqu,extra);
-			 break;
-
-	case MP_START:
-			DBG_8192D("set case mp_start\n");
-			rtw_mp_start (dev,info,wrqu,extra);
-			 break;
-
-	case MP_STOP:
-			DBG_8192D("set case mp_stop\n");
-			rtw_mp_stop (dev,info,wrqu,extra);
-			 break;
-
-	case MP_BANDWIDTH:
-			DBG_8192D("set case mp_bandwidth\n");
-			rtw_mp_bandwidth (dev,info,wrqu,extra);
-			break;
-
-	case MP_RESET_STATS:
-			DBG_8192D("set case MP_RESET_STATS\n");
-			rtw_mp_reset_stats	(dev,info,wrqu,extra);
-			break;
-
-	case EFUSE_SET:
-			DBG_8192D("efuse set\n");
-			rtw_mp_efuse_set (dev,info,wdata,extra);
-			break;
-
-	}
-
-
-	return 0;
-}
-
-
-static int rtw_mp_get(struct net_device *dev,
-			struct iw_request_info *info,
-			union iwreq_data *wdata, char *extra)
-{
-	struct iw_point *wrqu = (struct iw_point *)wdata;
-	u32 subcmd = wrqu->flags;
-	struct rtw_adapter * padapter = rtw_netdev_priv(dev);
-
-	//DBG_8192D("in mp_get extra= %s\n",extra);
-
-	if (padapter == NULL)
-	{
-		return -ENETDOWN;
-	}
-	if (extra == NULL)
-	{
-		wrqu->length = 0;
-		return -EIO;
-	}
-
-	switch (subcmd)
-	{
-	case MP_PHYPARA:
-			DBG_8192D("mp_get  MP_PHYPARA\n");
-			rtw_mp_phypara(dev,info,wrqu,extra);
-			break;
-
-	case MP_CHANNEL:
-			DBG_8192D("set case mp_channel\n");
-			rtw_mp_channel (dev,info,wrqu,extra);
-			break;
-
-	case READ_REG:
-			DBG_8192D("mp_get  READ_REG\n");
-			rtw_mp_read_reg (dev,info,wrqu,extra);
-			 break;
-	case READ_RF:
-			DBG_8192D("mp_get  READ_RF\n");
-			rtw_mp_read_rf (dev,info,wrqu,extra);
-			break;
-
-	case MP_RATE:
-			DBG_8192D("set case mp_rate\n");
-			rtw_mp_rate (dev,info,wrqu,extra);
-			break;
-
-	case MP_TXPOWER:
-			DBG_8192D("set case MP_TXPOWER\n");
-			rtw_mp_txpower (dev,info,wrqu,extra);
-			break;
-
-	case MP_ANT_TX:
-			DBG_8192D("set case MP_ANT_TX\n");
-			rtw_mp_ant_tx (dev,info,wrqu,extra);
-			break;
-
-	case MP_ANT_RX:
-			DBG_8192D("set case MP_ANT_RX\n");
-			rtw_mp_ant_rx (dev,info,wrqu,extra);
-			break;
-
-	case MP_QUERY:
-			DBG_8192D("mp_get mp_query MP_QUERY\n");
-			rtw_mp_trx_query(dev,info,wrqu,extra);
-			break;
-
-	case MP_CTX:
-			DBG_8192D("set case MP_CTX\n");
-			rtw_mp_ctx (dev,info,wrqu,extra);
-			break;
-
-	case MP_ARX:
-			DBG_8192D("set case MP_ARX\n");
-			rtw_mp_arx (dev,info,wrqu,extra);
-			break;
-
-	case EFUSE_GET:
-			DBG_8192D("efuse get EFUSE_GET\n");
-			rtw_mp_efuse_get(dev,info,wdata,extra);
-		 break;
-
-	case MP_DUMP:
-			DBG_8192D("set case MP_DUMP\n");
-			rtw_mp_dump (dev,info,wrqu,extra);
-		 break;
-	case MP_PSD:
-			DBG_8192D("set case MP_PSD\n");
-			rtw_mp_psd (dev,info,wrqu,extra);
-		 break;
-
-	case MP_THER:
-			DBG_8192D("set case MP_THER\n");
-			rtw_mp_thermal (dev,info,wrqu,extra);
-		break;
-
-	case MP_PWRTRK:
-			DBG_8192D("set case MP_PWRTRK\n");
-			rtw_mp_pwrtrk (dev,info,wrqu,extra);
-			break;
-	}
-
-return 0;
-}
-
-#endif //#if defined(CONFIG_MP_INCLUDED) && defined(CONFIG_MP_IWPRIV_SUPPORT)
-
 static int rtw_wfd_tdls_enable(struct net_device *dev,
 				struct iw_request_info *info,
 				union iwreq_data *wrqu, char *extra)
@@ -10108,66 +8927,6 @@ static iw_handler rtw_handlers[] =
 	NULL,					/*---hole---*/
 };
 
-#if defined(CONFIG_MP_INCLUDED) && defined(CONFIG_MP_IWPRIV_SUPPORT)
-
-static const struct iw_priv_args rtw_private_args[] =
-{
-	{ SIOCIWFIRSTPRIV + 0x00, IW_PRIV_TYPE_CHAR | 1024, 0 , ""},  //set
-	{ SIOCIWFIRSTPRIV + 0x01, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK , ""},//get
-/* --- sub-ioctls definitions --- */
-		{ MP_START , IW_PRIV_TYPE_CHAR | 1024, 0, "mp_start" }, //set
-		{ MP_PHYPARA, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_phypara" },//get
-		{ MP_STOP , IW_PRIV_TYPE_CHAR | 1024, 0, "mp_stop" }, //set
-		{ MP_CHANNEL , IW_PRIV_TYPE_CHAR | 1024 , IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_channel" },//get
-		{ MP_BANDWIDTH , IW_PRIV_TYPE_CHAR | 1024, 0, "mp_bandwidth"}, //set
-		{ MP_RATE , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_rate" },//get
-		{ MP_RESET_STATS , IW_PRIV_TYPE_CHAR | 1024, 0, "mp_reset_stats"},
-		{ MP_QUERY , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK , "mp_query"}, //get
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ READ_REG , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "read_reg" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_RATE , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_rate" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ READ_RF , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "read_rf" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_PSD , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_psd"},
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_DUMP, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_dump" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_TXPOWER , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_txpower"},
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_ANT_TX , IW_PRIV_TYPE_CHAR | 1024,  IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_ant_tx"},
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_ANT_RX , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_ant_rx"},
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ WRITE_REG , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "write_reg" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ WRITE_RF , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "write_rf" },
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_CTX , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_ctx"},
-		{ MP_NULL, IW_PRIV_TYPE_CHAR | 128, 0,"NULL"},//set
-		{ MP_ARX , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_arx"},
-		{ MP_ANT_RX , IW_PRIV_TYPE_CHAR | 1024, 0, "mp_ant_rx"},
-		{ MP_THER , IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_ther"},
-		{ EFUSE_SET, IW_PRIV_TYPE_CHAR | 1024, 0, "efuse_set" },
-		{ EFUSE_GET, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "efuse_get" },
-		{ MP_NULL , IW_PRIV_TYPE_CHAR | 1024, 0, "NULL"},
-		{ MP_PWRTRK, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK, "mp_pwrtrk" },
-		{ MP_IOCTL, IW_PRIV_TYPE_CHAR | 1024, 0, "mp_ioctl"}, // mp_ioctl
-
-
-	{ SIOCIWFIRSTPRIV + 0x02, IW_PRIV_TYPE_CHAR | 1024, IW_PRIV_TYPE_CHAR | IW_PRIV_SIZE_MASK , "test"},//set
-};
-
-
-static iw_handler rtw_private_handler[] =
-{
-	rtw_mp_set,
-	rtw_mp_get,
-};
-
-#else // not inlucde MP
-
 static const struct iw_priv_args rtw_private_args[] = {
 	{
 		SIOCIWFIRSTPRIV + 0x0,
@@ -10333,8 +9092,6 @@ static iw_handler rtw_private_handler[]
 #endif // CONFIG_INTEL_WIDI
 };
 
-#endif // #if defined(CONFIG_MP_INCLUDED) && defined(CONFIG_MP_IWPRIV_SUPPORT)
-
 #if WIRELESS_EXT >= 17
 static struct iw_statistics *rtw_get_wireless_stats(struct net_device *dev)
 {
--- a/drivers/staging/rtl8192du/os_dep/os_intfs.c
+++ b/drivers/staging/rtl8192du/os_dep/os_intfs.c
@@ -76,41 +76,37 @@ static int rtw_long_retry_lmt = 7;
 static int rtw_short_retry_lmt = 7;
 static int rtw_busy_thresh = 40;
 static int rtw_ack_policy = NORMAL_ACK;
-#ifdef CONFIG_MP_INCLUDED
-int rtw_mp_mode = 1;
-#else
-static int rtw_mp_mode = 0;
-#endif
-static int rtw_software_encrypt = 0;
-static int rtw_software_decrypt = 0;
+static int rtw_mp_mode;
+static int rtw_software_encrypt;
+static int rtw_software_decrypt;
 
-static int rtw_acm_method = 0;/*  0:By SW 1:By HW. */
+static int rtw_acm_method;/*  0:By SW 1:By HW. */
 
 static int rtw_wmm_enable = 1;/*  default is set to enable the wmm. */
-static int rtw_uapsd_enable = 0;
+static int rtw_uapsd_enable;
 static int rtw_uapsd_max_sp = NO_LIMIT;
-static int rtw_uapsd_acbk_en = 0;
-static int rtw_uapsd_acbe_en = 0;
-static int rtw_uapsd_acvi_en = 0;
-static int rtw_uapsd_acvo_en = 0;
+static int rtw_uapsd_acbk_en;
+static int rtw_uapsd_acbe_en;
+static int rtw_uapsd_acvi_en;
+static int rtw_uapsd_acvo_en;
 
 #ifdef CONFIG_80211N_HT
 int rtw_ht_enable = 1;
 int rtw_cbw40_enable = 3; /*  0 :diable, bit(0): enable 2.4g, bit(1): enable 5g */
 int rtw_ampdu_enable = 1;/* for enable tx_ampdu */
 static int rtw_rx_stbc = 1;/*  0: disable, bit(0):enable 2.4g, bit(1):enable 5g, default is set to enable 2.4GHZ for IOT issue with bufflao's AP at 5GHZ */
-static int rtw_ampdu_amsdu = 0;/*  0: disabled, 1:enabled, 2:auto */
+static int rtw_ampdu_amsdu;/*  0: disabled, 1:enabled, 2:auto */
 #endif
 
 static int rtw_lowrate_two_xmit = 1;/* Use 2 path Tx to transmit MCS0~7 and legacy mode */
 
 /* int rf_config = RF_1T2R;   1T2R */
 static int rtw_rf_config = RF_819X_MAX_TYPE;  /* auto */
-static int rtw_low_power = 0;
+static int rtw_low_power;
 #ifdef CONFIG_WIFI_TEST
 int rtw_wifi_spec = 1;/* for wifi test */
 #else
-static int rtw_wifi_spec = 0;
+static int rtw_wifi_spec;
 #endif
 
 static int rtw_special_rf_path = 0; /* 0: 2T2R , 1: only turn on path A 1T1R, 2: only turn on path B 1T1R */
@@ -1288,12 +1284,6 @@ _func_enter_;
 
 	rtw_init_pwrctrl_priv(padapter);
 
-#ifdef CONFIG_MP_INCLUDED
-	if (init_mp_priv(padapter) == _FAIL) {
-		DBG_8192D("%s: initialize MP private data Fail!\n", __func__);
-	}
-#endif
-
 	ret8 = rtw_init_default_value(padapter);
 
 	rtw_hal_dm_init(padapter);
