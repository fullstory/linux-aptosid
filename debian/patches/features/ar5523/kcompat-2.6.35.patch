--- a/drivers/staging/ar5523/ar5523.c
+++ b/drivers/staging/ar5523/ar5523.c
@@ -1117,8 +1117,8 @@ static void ar5523_free_tx_cmds(struct a
 		struct ar5523_tx_cmd *cmd = &ar->tx_cmd[i];
 
 		usb_kill_urb(cmd->urb);
-		usb_buffer_free(ar->dev, AR5523_MAX_TXCMDSZ,
-				cmd->buf, cmd->urb->transfer_dma);
+		usb_free_coherent(ar->dev, AR5523_MAX_TXCMDSZ,
+				  cmd->buf, cmd->urb->transfer_dma);
 		usb_free_urb(cmd->urb);
 	}
 }
@@ -1137,9 +1137,9 @@ static int ar5523_alloc_tx_cmds(struct a
 			ar5523_err(ar, "could not allocate tx urb\n");
 			goto out;
 		}
-		cmd->buf = usb_buffer_alloc(ar->dev, AR5523_MAX_TXCMDSZ,
-					    GFP_KERNEL,
-					    &cmd->urb->transfer_dma);
+		cmd->buf = usb_alloc_coherent(ar->dev, AR5523_MAX_TXCMDSZ,
+					      GFP_KERNEL,
+					      &cmd->urb->transfer_dma);
 		if (!cmd->buf) {
 			ar5523_err(ar, "could not allocate tx buffer\n");
 			usb_free_urb(cmd->urb);
@@ -1154,8 +1154,8 @@ static int ar5523_alloc_tx_cmds(struct a
  	while (--i >= 0) {
 		struct ar5523_tx_cmd *cmd = &ar->tx_cmd[i];
 
-		usb_buffer_free(ar->dev, AR5523_MAX_TXCMDSZ,
-				cmd->buf, cmd->urb->transfer_dma);
+		usb_free_coherent(ar->dev, AR5523_MAX_TXCMDSZ,
+				  cmd->buf, cmd->urb->transfer_dma);
 		usb_free_urb(cmd->urb);
 	}
 
@@ -1170,8 +1170,8 @@ static void ar5523_free_rx_cmds(struct a
 		struct ar5523_rx_cmd *cmd = &ar->rx_cmd[i];
 
 		usb_kill_urb(cmd->urb);
-		usb_buffer_free(ar->dev, AR5523_MAX_RXCMDSZ,
-				cmd->buf, cmd->urb->transfer_dma);
+		usb_free_coherent(ar->dev, AR5523_MAX_RXCMDSZ,
+				  cmd->buf, cmd->urb->transfer_dma);
 		usb_free_urb(cmd->urb);
 	}
 }
@@ -1190,9 +1190,9 @@ static int ar5523_alloc_rx_cmds(struct a
 			ar5523_err(ar, "could not allocate rx urb\n");
 			goto out;
 		}
-		cmd->buf = usb_buffer_alloc(ar->dev, AR5523_MAX_TXCMDSZ,
-					    GFP_KERNEL,
-					    &cmd->urb->transfer_dma);
+		cmd->buf = usb_alloc_coherent(ar->dev, AR5523_MAX_TXCMDSZ,
+					      GFP_KERNEL,
+					      &cmd->urb->transfer_dma);
 		if (!cmd->buf) {
 			ar5523_err(ar, "could not allocate rx buffer\n");
 			usb_free_urb(cmd->urb);
@@ -1208,8 +1208,8 @@ static int ar5523_alloc_rx_cmds(struct a
 		if (error) {
 			ar5523_err(ar, "error %d when submitting rx urb\n",
 				       error);
-			usb_buffer_free(ar->dev, AR5523_MAX_RXCMDSZ,
-					cmd->buf, cmd->urb->transfer_dma);
+			usb_free_coherent(ar->dev, AR5523_MAX_RXCMDSZ,
+					  cmd->buf, cmd->urb->transfer_dma);
 			usb_free_urb(cmd->urb);
 			return error;
 		}
@@ -1223,8 +1223,8 @@ static int ar5523_alloc_rx_cmds(struct a
 
 		usb_kill_urb(cmd->urb);
 
-		usb_buffer_free(ar->dev, AR5523_MAX_RXCMDSZ,
-				cmd->buf, cmd->urb->transfer_dma);
+		usb_free_coherent(ar->dev, AR5523_MAX_RXCMDSZ,
+				  cmd->buf, cmd->urb->transfer_dma);
 		usb_free_urb(cmd->urb);
 	}
 
