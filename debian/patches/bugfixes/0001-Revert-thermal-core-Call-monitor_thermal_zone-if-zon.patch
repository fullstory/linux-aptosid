From 319558ce9801d67ae9e94694cf9ad2b57033517f Mon Sep 17 00:00:00 2001
From: Stefan Lippers-Hollmann <s.l-h@gmx.de>
Date: Mon, 15 Jul 2024 10:41:39 +0200
Subject: [PATCH] Revert "thermal: core: Call monitor_thermal_zone() if zone
 temperature is invalid"

This reverts commit a8a261774466d8691e555ea674c193bb1b09edab.
---
 drivers/thermal/thermal_core.c | 5 +----
 drivers/thermal/thermal_core.h | 6 ------
 2 files changed, 1 insertion(+), 10 deletions(-)

--- a/drivers/thermal/thermal_core.c
+++ b/drivers/thermal/thermal_core.c
@@ -300,8 +300,6 @@ static void monitor_thermal_zone(struct
 		thermal_zone_device_set_polling(tz, tz->passive_delay_jiffies);
 	else if (tz->polling_delay_jiffies)
 		thermal_zone_device_set_polling(tz, tz->polling_delay_jiffies);
-	else if (tz->temperature == THERMAL_TEMP_INVALID)
-		thermal_zone_device_set_polling(tz, msecs_to_jiffies(THERMAL_RECHECK_DELAY_MS));
 }
 
 static struct thermal_governor *thermal_get_tz_governor(struct thermal_zone_device *tz)
@@ -511,7 +509,7 @@ void __thermal_zone_device_update(struct
 	update_temperature(tz);
 
 	if (tz->temperature == THERMAL_TEMP_INVALID)
-		goto monitor;
+		return;
 
 	__thermal_zone_set_trips(tz);
 
@@ -533,7 +531,6 @@ void __thermal_zone_device_update(struct
 
 	thermal_debug_update_trip_stats(tz);
 
-monitor:
 	monitor_thermal_zone(tz);
 }
 
--- a/drivers/thermal/thermal_core.h
+++ b/drivers/thermal/thermal_core.h
@@ -133,12 +133,6 @@ struct thermal_zone_device {
 	struct thermal_trip_desc trips[] __counted_by(num_trips);
 };
 
-/*
- * Default delay after a failing thermal zone temperature check before
- * attempting to check it again.
- */
-#define THERMAL_RECHECK_DELAY_MS	250
-
 /* Default Thermal Governor */
 #if defined(CONFIG_THERMAL_DEFAULT_GOV_STEP_WISE)
 #define DEFAULT_THERMAL_GOVERNOR       "step_wise"
