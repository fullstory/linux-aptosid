From 1939cd2e4259e376d501d242824f7398c7e6c850 Mon Sep 17 00:00:00 2001
From: Stefan Lippers-Hollmann <s.l-h@gmx.de>
Date: Sun, 17 Jul 2016 21:37:24 +0200
Subject: [PATCH 6/9] Revert "ath9k: Allow platform override BTCoex pin"

This reverts commit c8770bcf5cefa8cbfae21c07c4fe3428f5a9d42a.
---
 drivers/net/wireless/ath/ath9k/btcoex.c | 45 ++++++++-------------------------
 include/linux/ath9k_platform.h          |  4 ---
 2 files changed, 10 insertions(+), 39 deletions(-)

--- a/drivers/net/wireless/ath/ath9k/btcoex.c
+++ b/drivers/net/wireless/ath/ath9k/btcoex.c
@@ -15,8 +15,6 @@
  */
 
 #include <linux/export.h>
-#include <linux/types.h>
-#include <linux/ath9k_platform.h>
 #include "hw.h"
 
 enum ath_bt_mode {
@@ -92,29 +90,6 @@ void ath9k_hw_init_btcoex_hw(struct ath_
 }
 EXPORT_SYMBOL(ath9k_hw_init_btcoex_hw);
 
-static void ath9k_hw_btcoex_pin_init(struct ath_hw *ah, u8 wlanactive_gpio,
-				     u8 btactive_gpio, u8 btpriority_gpio)
-{
-	struct ath_btcoex_hw *btcoex_hw = &ah->btcoex_hw;
-	struct ath9k_platform_data *pdata = ah->dev->platform_data;
-
-	if (btcoex_hw->scheme != ATH_BTCOEX_CFG_2WIRE &&
-	    btcoex_hw->scheme != ATH_BTCOEX_CFG_3WIRE)
-		return;
-
-	/* bt priority GPIO will be ignored by 2 wire scheme */
-	if (pdata && (pdata->bt_active_pin || pdata->bt_priority_pin ||
-		      pdata->wlan_active_pin)) {
-		btcoex_hw->btactive_gpio = pdata->bt_active_pin;
-		btcoex_hw->wlanactive_gpio = pdata->wlan_active_pin;
-		btcoex_hw->btpriority_gpio = pdata->bt_priority_pin;
-	} else {
-		btcoex_hw->btactive_gpio = btactive_gpio;
-		btcoex_hw->wlanactive_gpio = wlanactive_gpio;
-		btcoex_hw->btpriority_gpio = btpriority_gpio;
-	}
-}
-
 void ath9k_hw_btcoex_init_scheme(struct ath_hw *ah)
 {
 	struct ath_common *common = ath9k_hw_common(ah);
@@ -132,19 +107,19 @@ void ath9k_hw_btcoex_init_scheme(struct
 		btcoex_hw->scheme = ATH_BTCOEX_CFG_MCI;
 	} else if (AR_SREV_9300_20_OR_LATER(ah)) {
 		btcoex_hw->scheme = ATH_BTCOEX_CFG_3WIRE;
-
-		ath9k_hw_btcoex_pin_init(ah, ATH_WLANACTIVE_GPIO_9300,
-					 ATH_BTACTIVE_GPIO_9300,
-					 ATH_BTPRIORITY_GPIO_9300);
+		btcoex_hw->btactive_gpio = ATH_BTACTIVE_GPIO_9300;
+		btcoex_hw->wlanactive_gpio = ATH_WLANACTIVE_GPIO_9300;
+		btcoex_hw->btpriority_gpio = ATH_BTPRIORITY_GPIO_9300;
 	} else if (AR_SREV_9280_20_OR_LATER(ah)) {
-		if (AR_SREV_9285(ah))
+		btcoex_hw->btactive_gpio = ATH_BTACTIVE_GPIO_9280;
+		btcoex_hw->wlanactive_gpio = ATH_WLANACTIVE_GPIO_9280;
+
+		if (AR_SREV_9285(ah)) {
 			btcoex_hw->scheme = ATH_BTCOEX_CFG_3WIRE;
-		else
+			btcoex_hw->btpriority_gpio = ATH_BTPRIORITY_GPIO_9285;
+		} else {
 			btcoex_hw->scheme = ATH_BTCOEX_CFG_2WIRE;
-
-		ath9k_hw_btcoex_pin_init(ah, ATH_WLANACTIVE_GPIO_9280,
-					 ATH_BTACTIVE_GPIO_9280,
-					 ATH_BTPRIORITY_GPIO_9285);
+		}
 	}
 }
 EXPORT_SYMBOL(ath9k_hw_btcoex_init_scheme);
--- a/include/linux/ath9k_platform.h
+++ b/include/linux/ath9k_platform.h
@@ -31,10 +31,6 @@ struct ath9k_platform_data {
 	u32 gpio_mask;
 	u32 gpio_val;
 
-	u32 bt_active_pin;
-	u32 bt_priority_pin;
-	u32 wlan_active_pin;
-
 	bool endian_check;
 	bool is_clk_25mhz;
 	bool tx_gain_buffalo;
